define(["lodash"],function(e){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(t,n){t.exports=e},,,function(e,t){e.exports='<h3 class="page-heading">Enter your Kentik Credentials</h3>\n<div class="gf-form-group">\n  <div class="gf-form" ng-if="ctrl.apiError && ctrl.appModel.enabled">\n    <span>Invalid API credentials. This app wont work until the credentials are updated.</span>\n  </div>\n  <div class="gf-form">\n    <label class="gf-form-label width-10">Email</label>\n    \x3c!-- Hidden input to stop chrome from autofilling --\x3e\n    <input style="display:none;" type="text" name="somefakename" />\n    <input type="text" class="gf-form-input max-width-20" ng-model=\'ctrl.appModel.jsonData.email\' placeholder="email" />\n  </div>\n  <div class="gf-form-inline">\n    <div class="gf-form kentik-inline-field-margin--right">\n      <label class="gf-form-label width-10">Api Token</label>\n      \x3c!-- Hidden input to stop chrome from autofilling --\x3e\n      <input style="display:none;" type="password" name="anotherfakename" />\n      <input type="password" class="gf-form-input max-width-20" ng-model="ctrl.appModel.secureJsonData.token" ng-if="!ctrl.appModel.jsonData.tokenSet"\n        placeholder="api token" />\n      <div ng-if="ctrl.appModel.jsonData.tokenSet" class="gf-form">\n        <input type="text" class="gf-form-input max-width-20" disabled="disabled" value="saved" />\n        <div ng-if="ctrl.appModel.enabled">\n          <i class="fa fa-exclamation-triangle" ng-if="!ctrl.apiValidated" alt="Could not validate api Token."></i>\n        </div>\n      </div>\n    </div>\n    <div class="gf-form">\n      <a class="btn btn-danger btn-small" href="#" ng-click="ctrl.reset()" ng-if="ctrl.appModel.jsonData.tokenSet">reset</a>\n    </div>\n  </div>\n</div>\n\n<div ng-if="ctrl.appModel.jsonData.tokenSet" class="kentik-enabled-box">\n  <i class="icon-gf icon-gf-check icon-gf-check kentik-icon-success"></i> Successfully enabled. <strong>Next up:\n  </strong><a href="dashboard/db/kentik-home" class="external-link">Go to Kentik Home Dashboard</a>\n</div>\n'},function(e,t,n){"use strict";n.r(t),n.d(t,"ConfigCtrl",function(){return r});var a=n(3),i=n.n(a),o=n(0),r=function(){function e(e,t,n){this.backendSrv=n,this.appEditCtrl.setPreUpdateHook(this.preUpdate.bind(this)),this.appEditCtrl.setPostUpdateHook(this.postUpdate.bind(this)),this.appModel.jsonData||(this.appModel.jsonData={}),this.appModel.secureJsonData||(this.appModel.secureJsonData={}),this.apiValidated=!1,this.apiError=!1,this.appModel.enabled&&this.appModel.jsonData.tokenSet&&this.validateApiConnection()}return e.$inject=["$scope","$injector","backendSrv"],e.prototype.preUpdate=function(){return this.appModel.secureJsonData.token&&(this.appModel.jsonData.tokenSet=!0),this.initDatasource()},e.prototype.postUpdate=function(){if(!this.appModel.enabled)return Promise.resolve();var e=this;return this.validateApiConnection().then(function(){return e.appEditCtrl.importDashboards().then(function(){return{url:"dashboard/db/kentik-home",message:"Kentik Connect Pro app installed!"}})})},e.prototype.validateApiConnection=function(){var e=this,t=this.backendSrv.get("/api/plugin-proxy/kentik-app/api/v5/users");return t.then(function(){e.apiValidated=!0},function(){e.apiValidated=!1,e.apiError=!0}),t},e.prototype.reset=function(){this.appModel.jsonData.email="",this.appModel.jsonData.tokenSet=!1,this.appModel.secureJsonData={},this.apiValidated=!1},e.prototype.initDatasource=function(){var e=this;return e.backendSrv.get("/api/datasources").then(function(t){var n=!1;o.forEach(t,function(e){n||"kentik"===e.name&&(n=!0)});var a=[];if(!n){a.push(e.backendSrv.post("/api/datasources",{name:"kentik",type:"kentik-ds",access:"direct",jsonData:{}}))}return Promise.all(a)})},e}();r.template=i.a}])});
//# sourceMappingURL=module.js.map