define(["lodash","angular","app/core/core","app/plugins/sdk"],function(t,e,n,r){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=16)}([function(e,n){e.exports=t},function(t,e,n){"use strict";function r(t){var e="default";for(var n in t)if("kentik-ds"===t[n].type)return e=t[n].jsonData.region;return e}n.d(e,"a",function(){return r})},function(t,n){t.exports=e},function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"b",function(){return a});var r=n(5),i=n(0);function o(t){var e="";e+=t.status?"("+t.status+") ":"",e+=t.statusText?t.statusText+": ":"",t.data&&t.data.error?e+=t.data.error:t.err?e+=t.err:i.isString(t)&&(e+=t),r.appEvents.emit("alert-error",["Can't connect to Kentik API",e])}function a(t,e,n){var o="";o+=e.status?"("+e.status+") ":"",o+=e.statusText?e.statusText+": ":"",e.data&&e.data.error?o+=e.data.error:e.err?o+=e.err:i.isString(e)&&(o+=e),r.appEvents.emit("alert-"+n,[t,o])}},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(2),i=n.n(r),o=n(1),a=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,u)}s((r=r.apply(t,e||[])).next())})},u=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},s=function(){function t(t){var e=this;this.backendSrv=t,this.apiReady=!1,this.baseUrl="/api/plugin-proxy/kentik-app",t.get("/api/datasources").then(function(t){e.region=Object(o.a)(t),e.setRegion(e.region),e.apiReady=!0})}return t.$inject=["backendSrv"],t.prototype.setRegion=function(t){this.region=t},t.prototype.getDevices=function(){return a(this,void 0,void 0,function(){var t,e=this;return u(this,function(n){switch(n.label){case 0:return this.backendSrv.get("/api/datasources").then(function(t){e.region=Object(o.a)(t),e.setRegion(e.region),e.apiReady=!0}),[4,this._get("/api/v5/devices")];case 1:return(t=n.sent()).data&&t.data.devices?[2,t.data.devices]:[2,[]]}})})},t.prototype.getUsers=function(){return this._get("/api/v5/users")},t.prototype.getFieldValues=function(t){var e="SELECT DISTINCT "+t+" FROM all_devices ORDER BY "+t+" ASC";return this.invokeSQLQuery(e)},t.prototype.getCustomDimensions=function(){return a(this,void 0,void 0,function(){return u(this,function(t){switch(t.label){case 0:return[4,this._get("/api/v5/customdimensions")];case 1:return[2,t.sent().data.customDimensions]}})})},t.prototype.getSavedFilters=function(){return a(this,void 0,void 0,function(){return u(this,function(t){switch(t.label){case 0:return[4,this._get("/api/v5/saved-filters")];case 1:return[2,t.sent().data]}})})},t.prototype.invokeTopXDataQuery=function(t){var e={queries:[{query:t,bucketIndex:0}]};return this._post("/api/v5/query/topXdata",e)},t.prototype.invokeSQLQuery=function(t){var e={query:t};return this._post("/api/v5/query/sql",e)},t.prototype._get=function(t){return a(this,void 0,void 0,function(){var e=this;return u(this,function(n){switch(n.label){case 0:return void 0!==this.region?[3,2]:[4,this.backendSrv.get("/api/datasources").then(function(t){e.setRegion(Object(o.a)(t))})];case 1:n.sent(),n.label=2;case 2:return[2,this.backendSrv.datasourceRequest({method:"GET",url:this.baseUrl+"/"+this.region+t}).catch(function(t){return console.error(t),t.err?Promise.reject(t.err):Promise.reject(t)})]}})})},t.prototype._post=function(t,e){return a(this,void 0,void 0,function(){var n=this;return u(this,function(r){switch(r.label){case 0:return void 0!==this.region?[3,2]:[4,this.backendSrv.get("/api/datasources").then(function(t){n.setRegion(Object(o.a)(t))})];case 1:r.sent(),r.label=2;case 2:return[2,this.backendSrv.datasourceRequest({method:"POST",url:this.baseUrl+"/"+this.region+t,data:e}).then(function(t){return t.data?t.data:[]}).catch(function(t){return console.error(t),t.err?Promise.reject(t.err):Promise.reject(t)})]}})})},t}();i.a.module("grafana.services").service("kentikAPISrv",s)},function(t,e){t.exports=n},function(t,e){t.exports=r},,,,,,,,,,function(t,e,n){"use strict";n.r(e),n.d(e,"PanelCtrl",function(){return d});var r,i=n(4),o=n(3),a=n(6),u=n(1),s=n(0),c=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,u)}s((r=r.apply(t,e||[])).next())})},f=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object(a.loadPluginCss)({dark:"plugins/kentik-app/css/kentik.dark.css",light:"plugins/kentik-app/css/kentik.light.css"});var p={fullscreen:!0},d=function(t){function e(e,n,r,o){var a=t.call(this,e,n)||this;return a.$location=r,a.backendSrv=o,s.defaults(a.panel,p),a.devices=[],a.pageReady=!1,a.region="default",o.get("/api/datasources").then(function(t){a.region=Object(u.a)(t),a.kentik=new i.a(a.backendSrv),a.kentik.setRegion(a.region)}).then(function(){return l(a,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return[4,this.getDevices()];case 1:return t.sent(),[2]}})})}),a}return c(e,t),e.$inject=["$scope","$injector","$location","backendSrv"],e.prototype.getDevices=function(){return l(this,void 0,void 0,function(){var t,e;return f(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this,[4,this.kentik.getDevices()];case 1:return t.devices=n.sent(),this.pageReady=!0,[3,3];case 2:return e=n.sent(),Object(o.a)(e),[3,3];case 3:return[2]}})})},e.prototype.refresh=function(){this.getDevices()},e.prototype.gotoDashboard=function(t){this.$location.path("/dashboard/db/kentik-top-talkers").search({"var-device":t.device_name})},e.prototype.gotoDeviceDetail=function(t){this.$location.url("/plugins/kentik-app/page/device-details?device="+t.id)},e}(a.PanelCtrl);d.templateUrl="public/plugins/kentik-app/components/device_list.html"}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwibG9kYXNoXCIiLCJ3ZWJwYWNrOi8vLy4vZGF0YXNvdXJjZS9yZWdpb25IZWxwZXIudHMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiYW5ndWxhclwiIiwid2VicGFjazovLy8uL2RhdGFzb3VyY2UvYWxlcnRIZWxwZXIudHMiLCJ3ZWJwYWNrOi8vLy4vZGF0YXNvdXJjZS9rZW50aWtBUEkudHMiLCJ3ZWJwYWNrOi8vLy4vcGFuZWwvZGV2aWNlLWxpc3QvbW9kdWxlLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fMF9fIiwiZ2V0UmVnaW9uIiwiZGF0YXNvdXJjZXMiLCJhUmVnaW9uIiwiaW5kZXgiLCJ0eXBlIiwianNvbkRhdGEiLCJyZWdpb24iLCJfX3dlYnBhY2tfZXhwb3J0c19fIiwiX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fMl9fIiwic2hvd0FsZXJ0Iiwic2hvd0N1c3RvbUFsZXJ0IiwiZ3JhZmFuYV9hcHBfY29yZV9jb3JlX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18iLCJsb2Rhc2hfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfXyIsImVycm9yIiwibWVzc2FnZSIsInN0YXR1cyIsInN0YXR1c1RleHQiLCJkYXRhIiwiZXJyIiwiZW1pdCIsImV4Y2VwdGlvbkRhdGEiLCJleGNlcHRpb25UeXBlIiwiZXJyTWVzc2FnZSIsIktlbnRpa0FQSSIsImJhY2tlbmRTcnYiLCJfdGhpcyIsInRoaXMiLCJhcGlSZWFkeSIsImJhc2VVcmwiLCJ0aGVuIiwiYWxsRFMiLCJfcmVnaW9uSGVscGVyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX18iLCJzZXRSZWdpb24iLCIkaW5qZWN0IiwicmVzcCIsIl9hIiwic2VudCIsImRldmljZXMiLCJnZXRVc2VycyIsIl9nZXQiLCJnZXRGaWVsZFZhbHVlcyIsImZpZWxkIiwicXVlcnkiLCJpbnZva2VTUUxRdWVyeSIsImludm9rZVRvcFhEYXRhUXVlcnkiLCJrZW50aWtWNVF1ZXJ5IiwicXVlcmllcyIsImJ1Y2tldEluZGV4IiwiX3Bvc3QiLCJkYXRhc291cmNlUmVxdWVzdCIsIm1ldGhvZCIsInVybCIsImNhdGNoIiwiY29uc29sZSIsIlByb21pc2UiLCJyZWplY3QiLCJyZXNwb25zZSIsImdyYWZhbmFfYXBwX3BsdWdpbnNfc2RrX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX18iLCJkYXJrIiwibGlnaHQiLCJwYW5lbERlZmF1bHRzIiwiZnVsbHNjcmVlbiIsIkRldmljZUxpc3RDdHJsIiwiX3N1cGVyIiwiJHNjb3BlIiwiJGluamVjdG9yIiwiJGxvY2F0aW9uIiwibG9kYXNoX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV80X18iLCJwYW5lbCIsInBhZ2VSZWFkeSIsIl9kYXRhc291cmNlX3JlZ2lvbkhlbHBlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfM19fIiwia2VudGlrIiwiX2RhdGFzb3VyY2Vfa2VudGlrQVBJX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18iLCJnZXREZXZpY2VzIiwiX19leHRlbmRzIiwiX2IiLCJ0cnlzIiwicHVzaCIsInJlZnJlc2giLCJnb3RvRGFzaGJvYXJkIiwiZGV2aWNlIiwicGF0aCIsInNlYXJjaCIsInZhci1kZXZpY2UiLCJkZXZpY2VfbmFtZSIsImdvdG9EZXZpY2VEZXRhaWwiLCJpZCJdLCJtYXBwaW5ncyI6Im1HQUNBLElBQUFBLEVBQUEsR0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxHQUFBLENBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsUUFBQSxJQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUEwREEsT0FyREFGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsRUFBQSxDQUEwQ0ssWUFBQSxFQUFBQyxJQUFBTCxLQUsxQ1osRUFBQWtCLEVBQUEsU0FBQWhCLEdBQ0Esb0JBQUFpQixlQUFBQyxhQUNBTixPQUFBQyxlQUFBYixFQUFBaUIsT0FBQUMsWUFBQSxDQUF3REMsTUFBQSxXQUV4RFAsT0FBQUMsZUFBQWIsRUFBQSxjQUFpRG1CLE9BQUEsS0FRakRyQixFQUFBc0IsRUFBQSxTQUFBRCxFQUFBRSxHQUVBLEdBREEsRUFBQUEsSUFBQUYsRUFBQXJCLEVBQUFxQixJQUNBLEVBQUFFLEVBQUEsT0FBQUYsRUFDQSxLQUFBRSxHQUFBLGlCQUFBRixRQUFBRyxXQUFBLE9BQUFILEVBQ0EsSUFBQUksRUFBQVgsT0FBQVksT0FBQSxNQUdBLEdBRkExQixFQUFBa0IsRUFBQU8sR0FDQVgsT0FBQUMsZUFBQVUsRUFBQSxXQUF5Q1QsWUFBQSxFQUFBSyxVQUN6QyxFQUFBRSxHQUFBLGlCQUFBRixFQUFBLFFBQUFNLEtBQUFOLEVBQUFyQixFQUFBVSxFQUFBZSxFQUFBRSxFQUFBLFNBQUFBLEdBQWdILE9BQUFOLEVBQUFNLElBQXFCQyxLQUFBLEtBQUFELElBQ3JJLE9BQUFGLEdBSUF6QixFQUFBNkIsRUFBQSxTQUFBMUIsR0FDQSxJQUFBUyxFQUFBVCxLQUFBcUIsV0FDQSxXQUEyQixPQUFBckIsRUFBQSxTQUMzQixXQUFpQyxPQUFBQSxHQUVqQyxPQURBSCxFQUFBVSxFQUFBRSxFQUFBLElBQUFBLEdBQ0FBLEdBSUFaLEVBQUFhLEVBQUEsU0FBQWlCLEVBQUFDLEdBQXNELE9BQUFqQixPQUFBa0IsVUFBQUMsZUFBQTFCLEtBQUF1QixFQUFBQyxJQUd0RC9CLEVBQUFrQyxFQUFBLEdBSUFsQyxJQUFBbUMsRUFBQSxvQkNsRkFoQyxFQUFBRCxRQUFBa0MsZ0NDS0EsU0FBU0MsRUFBVUMsR0FDakIsSUFBSUMsRUFBVSxVQUNkLElBQUssSUFBSUMsS0FBU0YsRUFDaEIsR0FBZ0MsY0FBNUJBLEVBQVlFLEdBQU9DLEtBSXJCLE9BREFGLEVBQVVELEVBQVlFLEdBQU9FLFNBQVNDLE9BSTFDLE9BQU9KLEVBZlJ2QyxFQUFBVSxFQUFBa0MsRUFBQSxzQkFBQVAsbUJDQURsQyxFQUFBRCxRQUFBMkMsZ0NDQUE3QyxFQUFBVSxFQUFBa0MsRUFBQSxzQkFBQUUsSUFBQTlDLEVBQUFVLEVBQUFrQyxFQUFBLHNCQUFBRyxJQUFBLElBQUFDLEVBQUFoRCxFQUFBLEdBQUFpRCxFQUFBakQsRUFBQSxHQUdBLFNBQVM4QyxFQUFVSSxHQUNqQixJQUFJQyxFQUFVLEdBQ2RBLEdBQVdELEVBQU1FLE9BQVMsSUFBSUYsRUFBTUUsT0FBTSxLQUFPLEdBQ2pERCxHQUFXRCxFQUFNRyxXQUFhSCxFQUFNRyxXQUFhLEtBQU8sR0FDcERILEVBQU1JLE1BQVFKLEVBQU1JLEtBQUtKLE1BQzNCQyxHQUFXRCxFQUFNSSxLQUFLSixNQUNiQSxFQUFNSyxJQUNmSixHQUFXRCxFQUFNSyxJQUNSTixFQUFBLFNBQVdDLEtBQ3BCQyxHQUFXRCxHQUdiRixFQUFBLFVBQVVRLEtBQUssY0FBZSxDQUFDLDhCQUErQkwsSUFHaEUsU0FBU0osRUFBZ0JJLEVBQVNNLEVBQWVDLEdBQy9DLElBQUlDLEVBQWEsR0FDakJBLEdBQWNGLEVBQWNMLE9BQVMsSUFBSUssRUFBY0wsT0FBTSxLQUFPLEdBQ3BFTyxHQUFjRixFQUFjSixXQUFhSSxFQUFjSixXQUFhLEtBQU8sR0FDdkVJLEVBQWNILE1BQVFHLEVBQWNILEtBQUtKLE1BQzNDUyxHQUFjRixFQUFjSCxLQUFLSixNQUN4Qk8sRUFBY0YsSUFDdkJJLEdBQWNGLEVBQWNGLElBQ25CTixFQUFBLFNBQVdRLEtBQ3BCRSxHQUFjRixHQUVoQlQsRUFBQSxVQUFVUSxLQUFLLFNBQVNFLEVBQWlCLENBQUNQLEVBQVNRLDA0Q0N6QnJEQyxFQUFBLG9CQUtFQSxFQUFBQyxHQUFtQixJQUFBQyxFQUFBQyxLQUNqQkEsS0FBS0YsV0FBV0EsRUFDaEJFLEtBQUtDLFVBQVUsRUFDZkQsS0FBQUUsUUFBQSxpQ0FFT2hELElBQUEsb0JBQVNpRCxLQUFBLFNBQUFDLEdBQ2RMLEVBQUtuQixPQUFTN0IsT0FBTXNELEVBQVEsRUFBZHRELENBQWNxRCxHQUM1QkwsRUFBS08sVUFBUVAsRUFBUW5CLFFBQ3BCbUIsRUFBQUUsVUFBQSxJQWlITixPQXpIQ0osRUFBQVUsUUFBbUIsaUJBWVp0QyxVQUFTcUMsVUFBTyxTQUFBMUIsR0FDdEJvQixLQUFBcEIsK0lBR0MsY0FDRWtCLFdBQVc1QyxJQUFHLG9CQUFBaUQsS0FBQSxTQUFBQyxHQUNkTCxFQUFLbkIsT0FBUzdCLE9BQU1zRCxFQUFRLEVBQWR0RCxDQUFjcUQsR0FDNUJMLEVBQUtPLFVBQVFQLEVBQVFuQixRQUNwQm1CLEVBQUFFLFVBQUEsMENBRUcsU0FFTk8sRUFBSUMsRUFBS0MsUUFDUG5CLE1BQUFpQixFQUFBakIsS0FBT29CLFFBQ1IsR0FBQUgsRUFBQWpCLEtBQUFvQixTQUVBLGVBSUQxQyxVQUFnQjJDLFNBQUMsV0FDbEIsT0FBQVosS0FBQWEsS0FBQSxvQkFHTzVDLFVBQVE2QyxlQUFtQixTQUFLQyxHQUN0QyxJQUFBQyxFQUFZLG1CQUFxQkQsRUFBQyw4QkFBQUEsRUFBQSxPQUNuQyxPQUFBZixLQUFBaUIsZUFBQUQsNExBR08sV0FDTlAsRUFBQUMscU5BSU0sV0FDTkQsRUFBQUMscUJBSU16QyxVQUFBaUQsb0JBQWdCLFNBQUFGLE9BQ3BCRyxFQUFZLENBQ1pDLFFBQUEsRUFBQUosUUFBQUssWUFBQSxLQUdILE9BQUFyQixLQUFBc0IsTUFBQSx5QkFBQUgsTUFHT2xELFVBQU9nRCxlQUFBLFNBQUFELE9BQ1h6QixFQUFPLENBQ1B5QixTQUdILE9BQUFoQixLQUFBc0IsTUFBQSxvQkFBQS9CLG9JQUtHLGdCQUFBUyxLQUFBcEIsT0FBQSxHQUF1RCxJQUVyRCxFQUFLb0IsS0FBVUYsV0FBQTVDLElBQUEsb0JBQUFpRCxLQUFBLFNBQUFDLEdBQ2ZMLEVBQUFPLFVBQUF2RCxPQUFBc0QsRUFBZ0UsRUFBaEV0RCxDQUFnRXFELFlBSGxFLG1CQU1GLGVBQ0csR0FBa0JKLEtBQUFGLFdBQ2pCeUIsa0JBQWEsQ0FDYkMsT0FBSyxNQUNMQyxJQUFBekIsS0FBQUUsUUFBQSxJQUFBRixLQUFBcEIsT0FBQTZDLElBRUFDLE1BQU8sU0FBT3ZDLFVBQ2R3QyxRQUFJeEMsTUFBU0EsR0FDWEEsRUFBQUssSUFDRG9DLFFBQUFDLE9BQUExQyxFQUFBSyxLQUVBb0MsUUFBQUMsT0FBQTFDLCtJQU9ILGdCQUFBYSxLQUFBcEIsT0FBQSxPQUVFLEVBQUtvQixLQUFVRixXQUFBNUMsSUFBQSxvQkFBQWlELEtBQUEsU0FBQUMsR0FDZkwsRUFBQU8sVUFBQXZELE9BQUFzRCxFQUFnRSxFQUFoRXRELENBQWdFcUQsWUFIbEUsbUJBTUYsZUFDRyxHQUFrQkosS0FBQUYsV0FDakJ5QixrQkFBYyxDQUNkQyxPQUFLLE9BQ0xDLElBQUl6QixLQUFNRSxRQUFBLElBQUFGLEtBQUFwQixPQUFBNkMsRUFDVmxDLFNBRUFZLEtBQUksU0FBUzJCLFVBQ1hBLEVBQU92QyxLQUNSdUMsRUFBQXZDLEtBRUEsS0FHRG1DLE1BQU8sU0FBT3ZDLFVBQ2R3QyxRQUFJeEMsTUFBU0EsR0FDWEEsRUFBQUssSUFDRG9DLFFBQUFDLE9BQUExQyxFQUFBSyxLQUVBb0MsUUFBQUMsT0FBQTFDLFlBR1JVLEVBOUhELHcxRENNRWtDLEVBQThDLGdCQUM5Q0MsS0FBSyx5Q0FDSkMsTUFBQSxnREFHREMsRUFBZ0IsQ0FDaEJDLFlBQUEsR0FFMkJDLEVBQUEsU0FBU0MsWUFRRUQsRUFBQUUsRUFBY0MsRUFBQUMsRUFBQTFDLEdBQVMsSUFBQUMsRUFBQXNDLEVBQUE3RixLQUFBd0QsS0FBZXNDLEVBQUFDLElBQUF2QyxLQWdCdEUsT0FkSkQsRUFBQXlDLFlBQ0F6QyxFQUFLRCxXQUFhQSxFQUNsQjJDLEVBQXVCLFNBQUExQyxFQUFBMkMsTUFBQVIsR0FDdkJuQyxFQUFBWSxRQUFBLEdBQ0FaLEVBQUs0QyxXQUFTLElBRVovRCxPQUFLLFlBQ0ExQixJQUFBLG9CQUFhaUQsS0FBQSxTQUFBQyxHQUNsQkwsRUFBS25CLE9BQU83QixPQUFTNkYsRUFBYyxFQUF2QjdGLENBQXVCcUQsR0FDbENMLEVBQU04QyxPQUFBLElBQUFDLEVBQUEsRUFBQS9DLEVBQUFELHdHQUNQRSxLQUFBLFNBQUFTLHdCQUFBLFFBQXdCLEdBQUFULEtBQUErQyxnREFJdEJoRCxFQXNCUixPQXZDRWlELEVBQUFaLEVBQWdCQyxLQUNoQjlCLFFBQ0UsVUFBTSxZQUFRLFlBYWYsOElBSUcsU0FBZTBDLEVBQUFDLEtBQUFDLEtBQUEsTUFBTSxXQUFoQixHQUFVbkQsS0FBK0I2QyxPQUFBRSxtQkFDOUMseURBRUEsZ0VBTUpYLEVBQUNuRSxVQUFBbUYsUUFBQSxXQUVEcEQsS0FBQStDLGNBRUFYLEVBQUNuRSxVQUFBb0YsY0FBQSxTQUFBQyxHQUVEdEQsS0FBQXdDLFVBQUFlLEtBQUEsb0NBQXVCQyxPQUFBLENBQUFDLGFBQUFILEVBQUFJLGVBRXZCdEIsRUFBQ25FLFVBQUEwRixpQkFBQSxTQUFBTCxHQUNIdEQsS0FBQXdDLFVBQUFmLElBQUMsa0RBQUE2QixFQUFBTSxLQUVEeEIsRUE5QzZCLENBZ0RVTCxFQUFBIiwiZmlsZSI6InBhbmVsL2RldmljZS1saXN0L21vZHVsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAxNik7XG4iLCJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzBfXzsiLCIgLyoqXG4gICogUmV0dXJucyB0aGUgcmVnaW9uIGFzc29jaWF0ZWQgd2l0aCB0aGUga2VudGlrLWtzXG5cbiAgKiBAcGFyYW0gZGF0YXNvdXJjZXMgXG4gICovXG5mdW5jdGlvbiBnZXRSZWdpb24oZGF0YXNvdXJjZXM6IGFueSk6IHN0cmluZyB7XG4gIGxldCBhUmVnaW9uID0gXCJkZWZhdWx0XCI7XG4gIGZvciAodmFyIGluZGV4IGluIGRhdGFzb3VyY2VzKSB7XG4gICAgaWYgKGRhdGFzb3VyY2VzW2luZGV4XS50eXBlID09PSBcImtlbnRpay1kc1wiKSB7XG4gICAgICAvL2NvbnNvbGUubG9nKFwiZ2V0UmVnaW9uOiBmb3VuZCByZWdpb246IFwiICtkYXRhc291cmNlc1tpbmRleF0uanNvbkRhdGEucmVnaW9uKTtcbiAgICAgIC8vY29uc29sZS5sb2coYWxsRFNbaW5kZXhdKTtcbiAgICAgIGFSZWdpb24gPSBkYXRhc291cmNlc1tpbmRleF0uanNvbkRhdGEucmVnaW9uO1xuICAgICAgcmV0dXJuIGFSZWdpb247XG4gICAgfVxuICB9XG4gIHJldHVybiBhUmVnaW9uO1xufVxuXG5leHBvcnQgeyBnZXRSZWdpb24gfVxuIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18yX187IiwiaW1wb3J0IHsgYXBwRXZlbnRzIH0gZnJvbSAnZ3JhZmFuYS9hcHAvY29yZS9jb3JlJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnbG9kYXNoJztcblxuZnVuY3Rpb24gc2hvd0FsZXJ0KGVycm9yKSB7XG4gIGxldCBtZXNzYWdlID0gJyc7XG4gIG1lc3NhZ2UgKz0gZXJyb3Iuc3RhdHVzID8gYCgke2Vycm9yLnN0YXR1c30pIGAgOiAnJztcbiAgbWVzc2FnZSArPSBlcnJvci5zdGF0dXNUZXh0ID8gZXJyb3Iuc3RhdHVzVGV4dCArICc6ICcgOiAnJztcbiAgaWYgKGVycm9yLmRhdGEgJiYgZXJyb3IuZGF0YS5lcnJvcikge1xuICAgIG1lc3NhZ2UgKz0gZXJyb3IuZGF0YS5lcnJvcjtcbiAgfSBlbHNlIGlmIChlcnJvci5lcnIpIHtcbiAgICBtZXNzYWdlICs9IGVycm9yLmVycjtcbiAgfSBlbHNlIGlmIChfLmlzU3RyaW5nKGVycm9yKSkge1xuICAgIG1lc3NhZ2UgKz0gZXJyb3I7XG4gIH1cblxuICBhcHBFdmVudHMuZW1pdCgnYWxlcnQtZXJyb3InLCBbXCJDYW4ndCBjb25uZWN0IHRvIEtlbnRpayBBUElcIiwgbWVzc2FnZV0pO1xufVxuXG5mdW5jdGlvbiBzaG93Q3VzdG9tQWxlcnQobWVzc2FnZSwgZXhjZXB0aW9uRGF0YSwgZXhjZXB0aW9uVHlwZSkge1xuICBsZXQgZXJyTWVzc2FnZSA9ICcnO1xuICBlcnJNZXNzYWdlICs9IGV4Y2VwdGlvbkRhdGEuc3RhdHVzID8gYCgke2V4Y2VwdGlvbkRhdGEuc3RhdHVzfSkgYCA6ICcnO1xuICBlcnJNZXNzYWdlICs9IGV4Y2VwdGlvbkRhdGEuc3RhdHVzVGV4dCA/IGV4Y2VwdGlvbkRhdGEuc3RhdHVzVGV4dCArICc6ICcgOiAnJztcbiAgaWYgKGV4Y2VwdGlvbkRhdGEuZGF0YSAmJiBleGNlcHRpb25EYXRhLmRhdGEuZXJyb3IpIHtcbiAgICBlcnJNZXNzYWdlICs9IGV4Y2VwdGlvbkRhdGEuZGF0YS5lcnJvcjtcbiAgfSBlbHNlIGlmIChleGNlcHRpb25EYXRhLmVycikge1xuICAgIGVyck1lc3NhZ2UgKz0gZXhjZXB0aW9uRGF0YS5lcnI7XG4gIH0gZWxzZSBpZiAoXy5pc1N0cmluZyhleGNlcHRpb25EYXRhKSkge1xuICAgIGVyck1lc3NhZ2UgKz0gZXhjZXB0aW9uRGF0YTtcbiAgfVxuICBhcHBFdmVudHMuZW1pdChgYWxlcnQtJHtleGNlcHRpb25UeXBlfWAsIFttZXNzYWdlLCBlcnJNZXNzYWdlXSk7XG59XG5cbmV4cG9ydCB7IHNob3dBbGVydCwgc2hvd0N1c3RvbUFsZXJ0IH07XG4iLCJpbXBvcnQgKiBhcyBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgYW5ndWxhciBmcm9tICdhbmd1bGFyJztcbmltcG9ydCB7IGdldFJlZ2lvbiB9IGZyb20gXCIuL3JlZ2lvbkhlbHBlclwiO1xuXG5leHBvcnQgY2xhc3MgS2VudGlrQVBJIHtcbiAgYmFzZVVybDogc3RyaW5nO1xuICByZWdpb246IHN0cmluZztcbiAgYXBpUmVhZHk6IGJvb2xlYW47XG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgY29uc3RydWN0b3IocHVibGljIGJhY2tlbmRTcnY6IGFueSkge1xuICAgIHRoaXMuYXBpUmVhZHkgPSBmYWxzZTtcbiAgICB0aGlzLmJhc2VVcmwgPSBcIi9hcGkvcGx1Z2luLXByb3h5L2tlbnRpay1hcHBcIjtcbiAgICAvLyBnZXQgcmVnaW9uIGZyb20gZGF0YXNvdXJjZVxuICAgIGJhY2tlbmRTcnYuZ2V0KCcvYXBpL2RhdGFzb3VyY2VzJykudGhlbiggKGFsbERTOiBhbnkpID0+IHtcbiAgICAgIHRoaXMucmVnaW9uID0gZ2V0UmVnaW9uKGFsbERTKTtcbiAgICAgIHRoaXMuc2V0UmVnaW9uKHRoaXMucmVnaW9uKTtcbiAgICAgIHRoaXMuYXBpUmVhZHkgPSB0cnVlO1xuICAgIH0pO1xuICB9XG5cbiAgc2V0UmVnaW9uKHJlZ2lvbjogc3RyaW5nKSB7XG4gICAgdGhpcy5yZWdpb24gPSByZWdpb247XG4gIH1cblxuICBhc3luYyBnZXREZXZpY2VzKCkge1xuICAgIHRoaXMuYmFja2VuZFNydi5nZXQoJy9hcGkvZGF0YXNvdXJjZXMnKS50aGVuKCAoYWxsRFM6IGFueSkgPT4ge1xuICAgICAgdGhpcy5yZWdpb24gPSBnZXRSZWdpb24oYWxsRFMpO1xuICAgICAgdGhpcy5zZXRSZWdpb24odGhpcy5yZWdpb24pO1xuICAgICAgdGhpcy5hcGlSZWFkeSA9IHRydWU7XG4gICAgfSk7XG5cbiAgICBjb25zdCByZXNwID0gYXdhaXQgdGhpcy5fZ2V0KCcvYXBpL3Y1L2RldmljZXMnKTtcblxuICAgIGlmIChyZXNwLmRhdGEgJiYgcmVzcC5kYXRhLmRldmljZXMpIHtcbiAgICAgIHJldHVybiByZXNwLmRhdGEuZGV2aWNlcztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgfVxuXG4gIGdldFVzZXJzKCkge1xuICAgIHJldHVybiB0aGlzLl9nZXQoJy9hcGkvdjUvdXNlcnMnKTtcbiAgfVxuXG4gIGdldEZpZWxkVmFsdWVzKGZpZWxkOiBzdHJpbmcpIHtcbiAgICBjb25zdCBxdWVyeSA9IGBTRUxFQ1QgRElTVElOQ1QgJHtmaWVsZH0gRlJPTSBhbGxfZGV2aWNlcyBPUkRFUiBCWSAke2ZpZWxkfSBBU0NgO1xuICAgIHJldHVybiB0aGlzLmludm9rZVNRTFF1ZXJ5KHF1ZXJ5KTtcbiAgfVxuXG4gIGFzeW5jIGdldEN1c3RvbURpbWVuc2lvbnMoKSB7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuX2dldCgnL2FwaS92NS9jdXN0b21kaW1lbnNpb25zJyk7XG4gICAgcmV0dXJuIGRhdGEuZGF0YS5jdXN0b21EaW1lbnNpb25zO1xuICB9XG5cbiAgYXN5bmMgZ2V0U2F2ZWRGaWx0ZXJzKCkge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLl9nZXQoJy9hcGkvdjUvc2F2ZWQtZmlsdGVycycpO1xuICAgIHJldHVybiBkYXRhLmRhdGE7XG4gIH1cblxuICBpbnZva2VUb3BYRGF0YVF1ZXJ5KHF1ZXJ5OiBhbnkpIHtcbiAgICBjb25zdCBrZW50aWtWNVF1ZXJ5ID0ge1xuICAgICAgcXVlcmllczogW3sgcXVlcnk6IHF1ZXJ5LCBidWNrZXRJbmRleDogMCB9XSxcbiAgICB9O1xuXG4gICAgcmV0dXJuIHRoaXMuX3Bvc3QoJy9hcGkvdjUvcXVlcnkvdG9wWGRhdGEnLCBrZW50aWtWNVF1ZXJ5KTtcbiAgfVxuXG4gIGludm9rZVNRTFF1ZXJ5KHF1ZXJ5OiBhbnkpIHtcbiAgICBjb25zdCBkYXRhID0ge1xuICAgICAgcXVlcnk6IHF1ZXJ5LFxuICAgIH07XG5cbiAgICByZXR1cm4gdGhpcy5fcG9zdCgnL2FwaS92NS9xdWVyeS9zcWwnLCBkYXRhKTtcbiAgfVxuXG4gIGFzeW5jIF9nZXQodXJsOiBzdHJpbmcpIHtcbiAgICAvLyBpZiB0aGUgcmVnaW9uIGlzIG5vdCBzZXQsIGdldCBpdCBmcm9tIHRoZSBkYXRhc291cmNlXG4gICAgaWYgKHR5cGVvZiB0aGlzLnJlZ2lvbiA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIC8vY29uc29sZS5sb2coXCJfZ2V0OiB0aGlzLnJlZ2lvbiBVTkRFRklORUQsIGZldGNoaW5nXCIpO1xuICAgICAgYXdhaXQgdGhpcy5iYWNrZW5kU3J2LmdldCgnL2FwaS9kYXRhc291cmNlcycpLnRoZW4oIChhbGxEUzogYW55KSA9PiB7XG4gICAgICAgIHRoaXMuc2V0UmVnaW9uKGdldFJlZ2lvbihhbGxEUykpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwia2VudGlrQVBJOiBfZ2V0OiBGRVRDSEVEIHJlZ2lvbiBcIiArIHRoaXMucmVnaW9uKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5iYWNrZW5kU3J2XG4gICAgICAuZGF0YXNvdXJjZVJlcXVlc3Qoe1xuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICB1cmw6IHRoaXMuYmFzZVVybCArIFwiL1wiICsgdGhpcy5yZWdpb24gKyB1cmwsXG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgIGlmIChlcnJvci5lcnIpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IuZXJyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIF9wb3N0KHVybDogc3RyaW5nLCBkYXRhOiBhbnkpIHtcbiAgICAvLyBpZiB0aGUgcmVnaW9uIGlzIG5vdCBzZXQsIGdldCBpdCBmcm9tIHRoZSBkYXRhc291cmNlXG4gICAgaWYgKHR5cGVvZiB0aGlzLnJlZ2lvbiA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIC8vY29uc29sZS5sb2coXCJrZW50aWtBUEkuX3Bvc3Q6IHRoaXMucmVnaW9uIFVOREVGSU5FRCwgZmV0Y2hpbmdcIik7XG4gICAgICBhd2FpdCB0aGlzLmJhY2tlbmRTcnYuZ2V0KCcvYXBpL2RhdGFzb3VyY2VzJykudGhlbiggKGFsbERTOiBhbnkpID0+IHtcbiAgICAgICAgdGhpcy5zZXRSZWdpb24oZ2V0UmVnaW9uKGFsbERTKSk7XG4gICAgICAgIC8vY29uc29sZS5sb2coXCJrZW50aWtBUEkuX3Bvc3Q6IEZFVENIRUQgcmVnaW9uIFwiICsgdGhpcy5yZWdpb24pO1xuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmJhY2tlbmRTcnZcbiAgICAgIC5kYXRhc291cmNlUmVxdWVzdCh7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICB1cmw6IHRoaXMuYmFzZVVybCArIFwiL1wiICsgdGhpcy5yZWdpb24gKyB1cmwsXG4gICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICB9KVxuICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSkge1xuICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICBpZiAoZXJyb3IuZXJyKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yLmVycik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gIH1cbn1cblxuYW5ndWxhci5tb2R1bGUoJ2dyYWZhbmEuc2VydmljZXMnKS5zZXJ2aWNlKCdrZW50aWtBUElTcnYnLCBLZW50aWtBUEkpO1xuIiwiaW1wb3J0IHsgS2VudGlrQVBJIH0gZnJvbSAnLi4vLi4vZGF0YXNvdXJjZS9rZW50aWtBUEknO1xuaW1wb3J0IHsgc2hvd0FsZXJ0IH0gZnJvbSBcIi4uLy4uL2RhdGFzb3VyY2UvYWxlcnRIZWxwZXJcIjtcblxuaW1wb3J0IHsgUGFuZWxDdHJsIH0gZnJvbSAnZ3JhZmFuYS9hcHAvcGx1Z2lucy9zZGsnO1xuaW1wb3J0IHsgbG9hZFBsdWdpbkNzcyB9IGZyb20gJ2dyYWZhbmEvYXBwL3BsdWdpbnMvc2RrJztcbmltcG9ydCB7IGdldFJlZ2lvbiB9IGZyb20gXCIuLi8uLi9kYXRhc291cmNlL3JlZ2lvbkhlbHBlclwiO1xuXG5pbXBvcnQgKiBhcyBfIGZyb20gJ2xvZGFzaCc7XG5cbmxvYWRQbHVnaW5Dc3Moe1xuICBkYXJrOiAncGx1Z2lucy9rZW50aWstYXBwL2Nzcy9rZW50aWsuZGFyay5jc3MnLFxuICBsaWdodDogJ3BsdWdpbnMva2VudGlrLWFwcC9jc3Mva2VudGlrLmxpZ2h0LmNzcycsXG59KTtcblxuY29uc3QgcGFuZWxEZWZhdWx0cyA9IHtcbiAgZnVsbHNjcmVlbjogdHJ1ZSxcbn07XG5cbmNsYXNzIERldmljZUxpc3RDdHJsIGV4dGVuZHMgUGFuZWxDdHJsIHtcbiAgc3RhdGljIHRlbXBsYXRlVXJsOiBhbnk7XG4gIGRldmljZXM6IGFueVtdO1xuICBwYWdlUmVhZHk6IGJvb2xlYW47XG4gIGtlbnRpazogS2VudGlrQVBJO1xuICByZWdpb246IHN0cmluZztcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIGNvbnN0cnVjdG9yKCRzY29wZSwgJGluamVjdG9yLCBwdWJsaWMgJGxvY2F0aW9uOiBhbnksIHB1YmxpYyBiYWNrZW5kU3J2OiBhbnkpIHtcbiAgICBzdXBlcigkc2NvcGUsICRpbmplY3Rvcik7XG4gICAgXy5kZWZhdWx0cyh0aGlzLnBhbmVsLCBwYW5lbERlZmF1bHRzKTtcbiAgICB0aGlzLmRldmljZXMgPSBbXTtcbiAgICB0aGlzLnBhZ2VSZWFkeSA9IGZhbHNlO1xuICAgIC8vIGdldCByZWdpb24gZnJvbSBkYXRhc291cmNlXG4gICAgdGhpcy5yZWdpb24gPSBcImRlZmF1bHRcIjtcbiAgICBiYWNrZW5kU3J2LmdldCgnL2FwaS9kYXRhc291cmNlcycpLnRoZW4oIChhbGxEUzogYW55KSA9PiB7XG4gICAgICB0aGlzLnJlZ2lvbiA9IGdldFJlZ2lvbihhbGxEUyk7XG4gICAgICB0aGlzLmtlbnRpayA9IG5ldyBLZW50aWtBUEkodGhpcy5iYWNrZW5kU3J2KTtcbiAgICAgIHRoaXMua2VudGlrLnNldFJlZ2lvbih0aGlzLnJlZ2lvbik7XG4gICAgfSkudGhlbiAoYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgdGhpcy5nZXREZXZpY2VzKCk7XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBnZXREZXZpY2VzKCkge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmRldmljZXMgPSBhd2FpdCB0aGlzLmtlbnRpay5nZXREZXZpY2VzKCk7XG4gICAgICB0aGlzLnBhZ2VSZWFkeSA9IHRydWU7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgc2hvd0FsZXJ0KGUpO1xuICAgIH1cbiAgfVxuXG4gIHJlZnJlc2goKSB7XG4gICAgdGhpcy5nZXREZXZpY2VzKCk7XG4gIH1cblxuICBnb3RvRGFzaGJvYXJkKGRldmljZSkge1xuICAgIHRoaXMuJGxvY2F0aW9uLnBhdGgoJy9kYXNoYm9hcmQvZGIva2VudGlrLXRvcC10YWxrZXJzJykuc2VhcmNoKHsgJ3Zhci1kZXZpY2UnOiBkZXZpY2UuZGV2aWNlX25hbWUgfSk7XG4gIH1cblxuICBnb3RvRGV2aWNlRGV0YWlsKGRldmljZSkge1xuICAgIHRoaXMuJGxvY2F0aW9uLnVybCgnL3BsdWdpbnMva2VudGlrLWFwcC9wYWdlL2RldmljZS1kZXRhaWxzP2RldmljZT0nICsgZGV2aWNlLmlkKTtcbiAgfVxufVxuXG5EZXZpY2VMaXN0Q3RybC50ZW1wbGF0ZVVybCA9ICdwdWJsaWMvcGx1Z2lucy9rZW50aWstYXBwL2NvbXBvbmVudHMvZGV2aWNlX2xpc3QuaHRtbCc7XG5cbmV4cG9ydCB7IERldmljZUxpc3RDdHJsIGFzIFBhbmVsQ3RybCB9O1xuIl0sInNvdXJjZVJvb3QiOiIifQ==