define(["lodash","angular","app/core/core"],function(e,t,i){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=10)}([function(t,i){t.exports=e},function(e,t,i){"use strict";function n(e){var t="default";for(var i in e)if("kentik-ds"===e[i].type)return"custom"===(t=e[i].jsonData.region)&&console.log("getRegion(): Custom Dynamic URL: "+e[i].jsonData.dynamicUrl),t;return t}i.d(t,"a",function(){return n})},function(e,t,i){"use strict";i.d(t,"a",function(){return o}),i.d(t,"b",function(){return c});var n=i(5),r=i(0);function o(e){var t="";t+=e.status?"("+e.status+") ":"",t+=e.statusText?e.statusText+": ":"",e.data&&e.data.error?t+=e.data.error:e.err?t+=e.err:r.isString(e)&&(t+=e),n.appEvents.emit("alert-error",["Can't connect to Kentik API",t])}function c(e,t,i){var o="";o+=t.status?"("+t.status+") ":"",o+=t.statusText?t.statusText+": ":"",t.data&&t.data.error?o+=t.data.error:t.err?o+=t.err:r.isString(t)&&(o+=t),n.appEvents.emit("alert-"+i,[e,o])}},function(e,i){e.exports=t},function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i(3),r=i.n(n),o=i(1),c=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function c(e){try{s(n.next(e))}catch(e){o(e)}}function a(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(c,a)}s((n=n.apply(e,t||[])).next())})},a=function(e,t){var i,n,r,o,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,n=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){c=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){c.label=o[1];break}if(6===o[0]&&c.label<r[1]){c.label=r[1],r=o;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(o);break}r[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},s=function(){function e(e){var t=this;this.backendSrv=e,this.apiReady=!1,this.baseUrl="/api/plugin-proxy/kentik-app",e.get("/api/datasources").then(function(e){t.region=Object(o.a)(e),t.setRegion(t.region),t.apiReady=!0})}return e.$inject=["backendSrv"],e.prototype.setRegion=function(e){this.region=e},e.prototype.getDevices=function(){return c(this,void 0,void 0,function(){var e,t=this;return a(this,function(i){switch(i.label){case 0:return this.backendSrv.get("/api/datasources").then(function(e){t.region=Object(o.a)(e),t.setRegion(t.region),t.apiReady=!0}),[4,this._get("/api/v5/devices")];case 1:return(e=i.sent()).data&&e.data.devices?[2,e.data.devices]:[2,[]]}})})},e.prototype.getUsers=function(){return c(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,this._get("/api/v5/users")];case 1:return[2,e.sent()]}})})},e.prototype.getFieldValues=function(e){var t="SELECT DISTINCT "+e+" FROM all_devices ORDER BY "+e+" ASC";return this.invokeSQLQuery(t)},e.prototype.getCustomDimensions=function(){return c(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,this._get("/api/v5/customdimensions")];case 1:return[2,e.sent().data.customDimensions]}})})},e.prototype.getSavedFilters=function(){return c(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,this._get("/api/v5/saved-filters")];case 1:return[2,e.sent().data]}})})},e.prototype.invokeTopXDataQuery=function(e){var t={queries:[{query:e,bucketIndex:0}]};return this._post("/api/v5/query/topXdata",t)},e.prototype.invokeSQLQuery=function(e){var t={query:e};return this._post("/api/v5/query/sql",t)},e.prototype._get=function(e){return c(this,void 0,void 0,function(){var t=this;return a(this,function(i){switch(i.label){case 0:return void 0!==this.region?[3,2]:[4,this.backendSrv.get("/api/datasources").then(function(e){t.setRegion(Object(o.a)(e))})];case 1:i.sent(),i.label=2;case 2:return[2,this.backendSrv.datasourceRequest({method:"GET",url:this.baseUrl+"/"+this.region+e}).catch(function(e){return console.error(e),e.err?Promise.reject(e.err):Promise.reject(e)})]}})})},e.prototype._post=function(e,t){return c(this,void 0,void 0,function(){var i=this;return a(this,function(n){switch(n.label){case 0:return void 0!==this.region?[3,2]:[4,this.backendSrv.get("/api/datasources").then(function(e){i.setRegion(Object(o.a)(e))})];case 1:n.sent(),n.label=2;case 2:return[2,this.backendSrv.datasourceRequest({method:"POST",url:this.baseUrl+"/"+this.region+e,data:t}).then(function(e){return e.data?e.data:[]}).catch(function(e){return console.error(e),e.err?Promise.reject(e.err):Promise.reject(e)})]}})})},e}();r.a.module("grafana.services").service("kentikAPISrv",s)},function(e,t){e.exports=i},,,,,function(e,t,i){"use strict";i.r(t),i.d(t,"DeviceDetailsCtrl",function(){return c});var n=i(4),r=i(2),o=i(1),c=function(){function e(e,t,i,r,c){var a=this;this.$location=i,this.backendSrv=r,this.alertSrv=c,this.device={},this.deviceDTO={},this.pageReady=!1,r.get("/api/datasources").then(function(e){a.region=Object(o.a)(e),a.kentik=new n.a(a.backendSrv),a.kentik.setRegion(a.region),a.getDevice(i.search().device)})}return e.$inject=["$scope","$injector","$location","backendSrv","alertSrv"],e.prototype.addIP=function(){this.otherIps.push({ip:""})},e.prototype.removeIP=function(e){this.otherIps.splice(e,1)},e.prototype.getDevice=function(e){var t=this;this.backendSrv.get("/api/plugin-proxy/kentik-app/"+this.region+"/api/v5/device/"+e).then(function(e){t.device=e.device,t.updateDeviceDTO(),t.pageReady=!0})},e.prototype.gotoDashboard=function(e){this.$location.url("/dashboard/db/kentik-top-talkers?var-device="+e)},e.prototype.updateDeviceDTO=function(){this.deviceDTO={device_id:this.device.id,device_name:this.device.device_name,device_type:this.device.device_type,device_description:this.device.device_description,device_flow_type:this.device.device_flow_type,device_sample_rate:parseInt(this.device.device_sample_rate,10),minimize_snmp:this.device.minimize_snmp,device_snmp_ip:this.device.device_snmp_ip,device_snmp_community:this.device.device_snmp_community,device_bgp_type:this.device.device_bgp_type,device_bgp_password:this.device.device_bgp_password,device_bgp_neighbor_ip:this.device.device_bgp_neighbor_ip,device_bgp_neighbor_asn:parseInt(this.device.device_bgp_neighbor_asn,10)}},e.prototype.update=function(){var e=this;this.deviceDTO.device_snmp_ip||delete this.deviceDTO.device_snmp_ip,this.deviceDTO.device_snmp_community||delete this.deviceDTO.device_snmp_community;var t={device:this.deviceDTO};this.backendSrv.put("/api/plugin-proxy/kentik-app/"+this.region+"/api/v5/device/"+this.deviceDTO.device_id,t).then(function(t){if(!("err"in t))return Object(r.b)("Device Updated.",e.deviceDTO.device_name,"success"),e.getDevice(e.deviceDTO.device_id);Object(r.b)("Device Update failed.",t.err,"error")},function(e){return"error"in e.data?void Object(r.b)("Device Update failed.",e.data.error,"error"):void Object(r.b)("Device Update failed.",e,"error")})},e}();c.templateUrl="components/device_details.html"}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwibG9kYXNoXCIiLCJ3ZWJwYWNrOi8vLy4vZGF0YXNvdXJjZS9yZWdpb25IZWxwZXIudHMiLCJ3ZWJwYWNrOi8vLy4vZGF0YXNvdXJjZS9hbGVydEhlbHBlci50cyIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJhbmd1bGFyXCIiLCJ3ZWJwYWNrOi8vLy4vZGF0YXNvdXJjZS9rZW50aWtBUEkudHMiLCJ3ZWJwYWNrOi8vLy4vY29tcG9uZW50cy9kZXZpY2VfZGV0YWlscy50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIl9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzBfXyIsImdldFJlZ2lvbiIsImRhdGFzb3VyY2VzIiwiYVJlZ2lvbiIsImluZGV4IiwidHlwZSIsImpzb25EYXRhIiwicmVnaW9uIiwiY29uc29sZSIsImxvZyIsImR5bmFtaWNVcmwiLCJfX3dlYnBhY2tfZXhwb3J0c19fIiwic2hvd0FsZXJ0Iiwic2hvd0N1c3RvbUFsZXJ0IiwiZ3JhZmFuYV9hcHBfY29yZV9jb3JlX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18iLCJsb2Rhc2hfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfXyIsImVycm9yIiwibWVzc2FnZSIsInN0YXR1cyIsInN0YXR1c1RleHQiLCJkYXRhIiwiZXJyIiwiZW1pdCIsImV4Y2VwdGlvbkRhdGEiLCJleGNlcHRpb25UeXBlIiwiZXJyTWVzc2FnZSIsIl9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzNfXyIsIktlbnRpa0FQSSIsImJhY2tlbmRTcnYiLCJfdGhpcyIsInRoaXMiLCJhcGlSZWFkeSIsImJhc2VVcmwiLCJ0aGVuIiwiYWxsRFMiLCJfcmVnaW9uSGVscGVyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX18iLCJzZXRSZWdpb24iLCIkaW5qZWN0IiwicmVzcCIsIl9hIiwic2VudCIsImRldmljZXMiLCJnZXRGaWVsZFZhbHVlcyIsImZpZWxkIiwicXVlcnkiLCJpbnZva2VTUUxRdWVyeSIsImludm9rZVRvcFhEYXRhUXVlcnkiLCJrZW50aWtWNVF1ZXJ5IiwicXVlcmllcyIsImJ1Y2tldEluZGV4IiwiX3Bvc3QiLCJkYXRhc291cmNlUmVxdWVzdCIsIm1ldGhvZCIsInVybCIsImNhdGNoIiwiUHJvbWlzZSIsInJlamVjdCIsInJlc3BvbnNlIiwiRGV2aWNlRGV0YWlsc0N0cmwiLCJfZGF0YXNvdXJjZV9rZW50aWtBUElfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfXyIsIl9kYXRhc291cmNlX2FsZXJ0SGVscGVyX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX18iLCJfZGF0YXNvdXJjZV9yZWdpb25IZWxwZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfXyIsIiRzY29wZSIsIiRpbmplY3RvciIsIiRsb2NhdGlvbiIsImFsZXJ0U3J2IiwiZGV2aWNlIiwiZGV2aWNlRFRPIiwicGFnZVJlYWR5Iiwia2VudGlrIiwiZ2V0RGV2aWNlIiwic2VhcmNoIiwiYWRkSVAiLCJvdGhlcklwcyIsInB1c2giLCJpcCIsInJlbW92ZUlQIiwic3BsaWNlIiwiZGV2aWNlSWQiLCJ1cGRhdGVEZXZpY2VEVE8iLCJnb3RvRGFzaGJvYXJkIiwiZGV2aWNlX25hbWUiLCJkZXZpY2VfaWQiLCJpZCIsImRldmljZV90eXBlIiwiZGV2aWNlX2Rlc2NyaXB0aW9uIiwiZGV2aWNlX2Zsb3dfdHlwZSIsImRldmljZV9zYW1wbGVfcmF0ZSIsInBhcnNlSW50IiwibWluaW1pemVfc25tcCIsImRldmljZV9zbm1wX2lwIiwiZGV2aWNlX3NubXBfY29tbXVuaXR5IiwiZGV2aWNlX2JncF90eXBlIiwiZGV2aWNlX2JncF9wYXNzd29yZCIsImRldmljZV9iZ3BfbmVpZ2hib3JfaXAiLCJkZXZpY2VfYmdwX25laWdoYm9yX2FzbiIsInVwZGF0ZSIsInB1dCJdLCJtYXBwaW5ncyI6IitFQUNBLElBQUFBLEVBQUEsR0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxHQUFBLENBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsUUFBQSxJQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUEwREEsT0FyREFGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsRUFBQSxDQUEwQ0ssWUFBQSxFQUFBQyxJQUFBTCxLQUsxQ1osRUFBQWtCLEVBQUEsU0FBQWhCLEdBQ0Esb0JBQUFpQixlQUFBQyxhQUNBTixPQUFBQyxlQUFBYixFQUFBaUIsT0FBQUMsWUFBQSxDQUF3REMsTUFBQSxXQUV4RFAsT0FBQUMsZUFBQWIsRUFBQSxjQUFpRG1CLE9BQUEsS0FRakRyQixFQUFBc0IsRUFBQSxTQUFBRCxFQUFBRSxHQUVBLEdBREEsRUFBQUEsSUFBQUYsRUFBQXJCLEVBQUFxQixJQUNBLEVBQUFFLEVBQUEsT0FBQUYsRUFDQSxLQUFBRSxHQUFBLGlCQUFBRixRQUFBRyxX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U0FBTUssUUFDcEQsUUFBQUEsR0FLSCxPQUZHNUQsT0FBQWtGLEVBQUEsRUFBQWxGLENBQUEsa0JBQUFtRCxFQUFBc0MsVUFBQWMsWUFBQSxXQUVIcEQsRUFBS3lDLFVBQUF6QyxFQUFBc0MsVUFBQWUsa0JBTEl0QixFQUFBLDJCQUFBdEIsRUFBQWpCLElBQUEsbUJBT0xMLFNBQ0EsVUFBT0EsRUFBQUksVUFDUjFDLE9BQUFrRixFQUFBLEVBQUFsRixDQUFBLHdCQUFBc0MsRUFBQUksS0FBQUosTUFBQSxjQUdBdEMsT0FBQWtGLEVBQUEsRUFBQWxGLENBQUEsd0JBQUFzQyxFQUFBLGNBOUVTIiwiZmlsZSI6ImNvbXBvbmVudHMvZGV2aWNlX2RldGFpbHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMTApO1xuIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18wX187IiwiIC8qKlxuICAqIFJldHVybnMgdGhlIHJlZ2lvbiBhc3NvY2lhdGVkIHdpdGggdGhlIGtlbnRpay1rc1xuXG4gICogQHBhcmFtIGRhdGFzb3VyY2VzIFxuICAqL1xuZnVuY3Rpb24gZ2V0UmVnaW9uKGRhdGFzb3VyY2VzOiBhbnkpOiBzdHJpbmcge1xuICBsZXQgYVJlZ2lvbiA9IFwiZGVmYXVsdFwiO1xuICBmb3IgKHZhciBpbmRleCBpbiBkYXRhc291cmNlcykge1xuICAgIGlmIChkYXRhc291cmNlc1tpbmRleF0udHlwZSA9PT0gXCJrZW50aWstZHNcIikge1xuICAgICAgYVJlZ2lvbiA9IGRhdGFzb3VyY2VzW2luZGV4XS5qc29uRGF0YS5yZWdpb247XG4gICAgICBpZiAoYVJlZ2lvbiA9PT0gJ2N1c3RvbScpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJnZXRSZWdpb24oKTogQ3VzdG9tIER5bmFtaWMgVVJMOiBcIiArIGRhdGFzb3VyY2VzW2luZGV4XS5qc29uRGF0YS5keW5hbWljVXJsKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcImdldFJlZ2lvbigpOiBDdXN0b20gRFMgSW5mbzogXCIgKyBKU09OLnN0cmluZ2lmeShkYXRhc291cmNlc1tpbmRleF0pKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhUmVnaW9uO1xuICAgIH1cbiAgfVxuICByZXR1cm4gYVJlZ2lvbjtcbn1cblxuZXhwb3J0IHsgZ2V0UmVnaW9uIH1cbiIsImltcG9ydCB7IGFwcEV2ZW50cyB9IGZyb20gJ2dyYWZhbmEvYXBwL2NvcmUvY29yZSc7XG5pbXBvcnQgKiBhcyBfIGZyb20gJ2xvZGFzaCc7XG5cbmZ1bmN0aW9uIHNob3dBbGVydChlcnJvcikge1xuICBsZXQgbWVzc2FnZSA9ICcnO1xuICBtZXNzYWdlICs9IGVycm9yLnN0YXR1cyA/IGAoJHtlcnJvci5zdGF0dXN9KSBgIDogJyc7XG4gIG1lc3NhZ2UgKz0gZXJyb3Iuc3RhdHVzVGV4dCA/IGVycm9yLnN0YXR1c1RleHQgKyAnOiAnIDogJyc7XG4gIGlmIChlcnJvci5kYXRhICYmIGVycm9yLmRhdGEuZXJyb3IpIHtcbiAgICBtZXNzYWdlICs9IGVycm9yLmRhdGEuZXJyb3I7XG4gIH0gZWxzZSBpZiAoZXJyb3IuZXJyKSB7XG4gICAgbWVzc2FnZSArPSBlcnJvci5lcnI7XG4gIH0gZWxzZSBpZiAoXy5pc1N0cmluZyhlcnJvcikpIHtcbiAgICBtZXNzYWdlICs9IGVycm9yO1xuICB9XG5cbiAgYXBwRXZlbnRzLmVtaXQoJ2FsZXJ0LWVycm9yJywgW1wiQ2FuJ3QgY29ubmVjdCB0byBLZW50aWsgQVBJXCIsIG1lc3NhZ2VdKTtcbn1cblxuZnVuY3Rpb24gc2hvd0N1c3RvbUFsZXJ0KG1lc3NhZ2UsIGV4Y2VwdGlvbkRhdGEsIGV4Y2VwdGlvblR5cGUpIHtcbiAgbGV0IGVyck1lc3NhZ2UgPSAnJztcbiAgZXJyTWVzc2FnZSArPSBleGNlcHRpb25EYXRhLnN0YXR1cyA/IGAoJHtleGNlcHRpb25EYXRhLnN0YXR1c30pIGAgOiAnJztcbiAgZXJyTWVzc2FnZSArPSBleGNlcHRpb25EYXRhLnN0YXR1c1RleHQgPyBleGNlcHRpb25EYXRhLnN0YXR1c1RleHQgKyAnOiAnIDogJyc7XG4gIGlmIChleGNlcHRpb25EYXRhLmRhdGEgJiYgZXhjZXB0aW9uRGF0YS5kYXRhLmVycm9yKSB7XG4gICAgZXJyTWVzc2FnZSArPSBleGNlcHRpb25EYXRhLmRhdGEuZXJyb3I7XG4gIH0gZWxzZSBpZiAoZXhjZXB0aW9uRGF0YS5lcnIpIHtcbiAgICBlcnJNZXNzYWdlICs9IGV4Y2VwdGlvbkRhdGEuZXJyO1xuICB9IGVsc2UgaWYgKF8uaXNTdHJpbmcoZXhjZXB0aW9uRGF0YSkpIHtcbiAgICBlcnJNZXNzYWdlICs9IGV4Y2VwdGlvbkRhdGE7XG4gIH1cbiAgYXBwRXZlbnRzLmVtaXQoYGFsZXJ0LSR7ZXhjZXB0aW9uVHlwZX1gLCBbbWVzc2FnZSwgZXJyTWVzc2FnZV0pO1xufVxuXG5leHBvcnQgeyBzaG93QWxlcnQsIHNob3dDdXN0b21BbGVydCB9O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18zX187IiwiaW1wb3J0ICogYXMgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgeyBnZXRSZWdpb24gfSBmcm9tIFwiLi9yZWdpb25IZWxwZXJcIjtcblxuZXhwb3J0IGNsYXNzIEtlbnRpa0FQSSB7XG4gIGJhc2VVcmw6IHN0cmluZztcbiAgcmVnaW9uOiBzdHJpbmc7XG4gIGFwaVJlYWR5OiBib29sZWFuO1xuICAvKiogQG5nSW5qZWN0ICovXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBiYWNrZW5kU3J2OiBhbnkpIHtcbiAgICB0aGlzLmFwaVJlYWR5ID0gZmFsc2U7XG4gICAgdGhpcy5iYXNlVXJsID0gXCIvYXBpL3BsdWdpbi1wcm94eS9rZW50aWstYXBwXCI7XG4gICAgLy8gZ2V0IHJlZ2lvbiBmcm9tIGRhdGFzb3VyY2VcbiAgICBiYWNrZW5kU3J2LmdldCgnL2FwaS9kYXRhc291cmNlcycpLnRoZW4oIChhbGxEUzogYW55KSA9PiB7XG4gICAgICB0aGlzLnJlZ2lvbiA9IGdldFJlZ2lvbihhbGxEUyk7XG4gICAgICB0aGlzLnNldFJlZ2lvbih0aGlzLnJlZ2lvbik7XG4gICAgICB0aGlzLmFwaVJlYWR5ID0gdHJ1ZTtcbiAgICB9KTtcbiAgfVxuXG4gIHNldFJlZ2lvbihyZWdpb246IHN0cmluZykge1xuICAgIHRoaXMucmVnaW9uID0gcmVnaW9uO1xuICB9XG5cbiAgYXN5bmMgZ2V0RGV2aWNlcygpIHtcbiAgICB0aGlzLmJhY2tlbmRTcnYuZ2V0KCcvYXBpL2RhdGFzb3VyY2VzJykudGhlbiggKGFsbERTOiBhbnkpID0+IHtcbiAgICAgIHRoaXMucmVnaW9uID0gZ2V0UmVnaW9uKGFsbERTKTtcbiAgICAgIHRoaXMuc2V0UmVnaW9uKHRoaXMucmVnaW9uKTtcbiAgICAgIHRoaXMuYXBpUmVhZHkgPSB0cnVlO1xuICAgIH0pO1xuXG4gICAgY29uc3QgcmVzcCA9IGF3YWl0IHRoaXMuX2dldCgnL2FwaS92NS9kZXZpY2VzJyk7XG5cbiAgICBpZiAocmVzcC5kYXRhICYmIHJlc3AuZGF0YS5kZXZpY2VzKSB7XG4gICAgICByZXR1cm4gcmVzcC5kYXRhLmRldmljZXM7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRVc2VycygpIHtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5fZ2V0KCcvYXBpL3Y1L3VzZXJzJylcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuXG4gIGdldEZpZWxkVmFsdWVzKGZpZWxkOiBzdHJpbmcpIHtcbiAgICBjb25zdCBxdWVyeSA9IGBTRUxFQ1QgRElTVElOQ1QgJHtmaWVsZH0gRlJPTSBhbGxfZGV2aWNlcyBPUkRFUiBCWSAke2ZpZWxkfSBBU0NgO1xuICAgIHJldHVybiB0aGlzLmludm9rZVNRTFF1ZXJ5KHF1ZXJ5KTtcbiAgfVxuXG4gIGFzeW5jIGdldEN1c3RvbURpbWVuc2lvbnMoKSB7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuX2dldCgnL2FwaS92NS9jdXN0b21kaW1lbnNpb25zJyk7XG4gICAgcmV0dXJuIGRhdGEuZGF0YS5jdXN0b21EaW1lbnNpb25zO1xuICB9XG5cbiAgYXN5bmMgZ2V0U2F2ZWRGaWx0ZXJzKCkge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLl9nZXQoJy9hcGkvdjUvc2F2ZWQtZmlsdGVycycpO1xuICAgIHJldHVybiBkYXRhLmRhdGE7XG4gIH1cblxuICBpbnZva2VUb3BYRGF0YVF1ZXJ5KHF1ZXJ5OiBhbnkpIHtcbiAgICBjb25zdCBrZW50aWtWNVF1ZXJ5ID0ge1xuICAgICAgcXVlcmllczogW3sgcXVlcnk6IHF1ZXJ5LCBidWNrZXRJbmRleDogMCB9XSxcbiAgICB9O1xuXG4gICAgcmV0dXJuIHRoaXMuX3Bvc3QoJy9hcGkvdjUvcXVlcnkvdG9wWGRhdGEnLCBrZW50aWtWNVF1ZXJ5KTtcbiAgfVxuXG4gIGludm9rZVNRTFF1ZXJ5KHF1ZXJ5OiBhbnkpIHtcbiAgICBjb25zdCBkYXRhID0ge1xuICAgICAgcXVlcnk6IHF1ZXJ5LFxuICAgIH07XG5cbiAgICByZXR1cm4gdGhpcy5fcG9zdCgnL2FwaS92NS9xdWVyeS9zcWwnLCBkYXRhKTtcbiAgfVxuXG4gIGFzeW5jIF9nZXQodXJsOiBzdHJpbmcpIHtcbiAgICAvLyBpZiB0aGUgcmVnaW9uIGlzIG5vdCBzZXQsIGdldCBpdCBmcm9tIHRoZSBkYXRhc291cmNlXG4gICAgaWYgKHR5cGVvZiB0aGlzLnJlZ2lvbiA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIC8vY29uc29sZS5sb2coXCJfZ2V0OiB0aGlzLnJlZ2lvbiBVTkRFRklORUQsIGZldGNoaW5nXCIpO1xuICAgICAgYXdhaXQgdGhpcy5iYWNrZW5kU3J2LmdldCgnL2FwaS9kYXRhc291cmNlcycpLnRoZW4oIChhbGxEUzogYW55KSA9PiB7XG4gICAgICAgIHRoaXMuc2V0UmVnaW9uKGdldFJlZ2lvbihhbGxEUykpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwia2VudGlrQVBJOiBfZ2V0OiBGRVRDSEVEIHJlZ2lvbiBcIiArIHRoaXMucmVnaW9uKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmJhY2tlbmRTcnZcbiAgICAgIC5kYXRhc291cmNlUmVxdWVzdCh7XG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIHVybDogdGhpcy5iYXNlVXJsICsgXCIvXCIgKyB0aGlzLnJlZ2lvbiArIHVybCxcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgICAgaWYgKGVycm9yLmVycikge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvci5lcnIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgX3Bvc3QodXJsOiBzdHJpbmcsIGRhdGE6IGFueSkge1xuICAgIC8vIGlmIHRoZSByZWdpb24gaXMgbm90IHNldCwgZ2V0IGl0IGZyb20gdGhlIGRhdGFzb3VyY2VcbiAgICBpZiAodHlwZW9mIHRoaXMucmVnaW9uID09PSAndW5kZWZpbmVkJykge1xuICAgICAgLy9jb25zb2xlLmxvZyhcImtlbnRpa0FQSS5fcG9zdDogdGhpcy5yZWdpb24gVU5ERUZJTkVELCBmZXRjaGluZ1wiKTtcbiAgICAgIGF3YWl0IHRoaXMuYmFja2VuZFNydi5nZXQoJy9hcGkvZGF0YXNvdXJjZXMnKS50aGVuKCAoYWxsRFM6IGFueSkgPT4ge1xuICAgICAgICB0aGlzLnNldFJlZ2lvbihnZXRSZWdpb24oYWxsRFMpKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcImtlbnRpa0FQSS5fcG9zdDogRkVUQ0hFRCByZWdpb24gXCIgKyB0aGlzLnJlZ2lvbik7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuYmFja2VuZFNydlxuICAgICAgLmRhdGFzb3VyY2VSZXF1ZXN0KHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIHVybDogdGhpcy5iYXNlVXJsICsgXCIvXCIgKyB0aGlzLnJlZ2lvbiArIHVybCxcbiAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgIH0pXG4gICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgIGlmIChyZXNwb25zZS5kYXRhKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgIGlmIChlcnJvci5lcnIpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IuZXJyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgfVxufVxuXG5hbmd1bGFyLm1vZHVsZSgnZ3JhZmFuYS5zZXJ2aWNlcycpLnNlcnZpY2UoJ2tlbnRpa0FQSVNydicsIEtlbnRpa0FQSSk7XG4iLCJpbXBvcnQgeyBLZW50aWtBUEkgfSBmcm9tICcuLi9kYXRhc291cmNlL2tlbnRpa0FQSSc7XG5pbXBvcnQgeyBzaG93Q3VzdG9tQWxlcnQgfSBmcm9tIFwiLi4vZGF0YXNvdXJjZS9hbGVydEhlbHBlclwiO1xuaW1wb3J0IHsgZ2V0UmVnaW9uIH0gZnJvbSBcIi4uL2RhdGFzb3VyY2UvcmVnaW9uSGVscGVyXCI7XG5cbmV4cG9ydCBjbGFzcyBEZXZpY2VEZXRhaWxzQ3RybCB7XG4gIHN0YXRpYyB0ZW1wbGF0ZVVybDogc3RyaW5nO1xuICBkZXZpY2U6IGFueTtcbiAgZGV2aWNlRFRPOiBhbnk7XG4gIHBhZ2VSZWFkeTogYm9vbGVhbjtcbiAgb3RoZXJJcHM6IGFueTtcbiAga2VudGlrOiBLZW50aWtBUEk7XG4gIHJlZ2lvbjogc3RyaW5nO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgY29uc3RydWN0b3IoJHNjb3BlLCAkaW5qZWN0b3IsIHB1YmxpYyAkbG9jYXRpb246IGFueSwgcHVibGljIGJhY2tlbmRTcnY6IGFueSwgcHVibGljIGFsZXJ0U3J2OiBhbnkpIHtcbiAgICB0aGlzLmRldmljZSA9IHt9O1xuICAgIHRoaXMuZGV2aWNlRFRPID0ge307XG4gICAgdGhpcy5wYWdlUmVhZHkgPSBmYWxzZTtcbiAgICAvLyBnZXQgcmVnaW9uIGZyb20gZGF0YXNvdXJjZVxuICAgIC8vdGhpcy5yZWdpb24gPSBcImRlZmF1bHRcIjtcbiAgICBiYWNrZW5kU3J2LmdldCgnL2FwaS9kYXRhc291cmNlcycpLnRoZW4oIChhbGxEUzogYW55KSA9PiB7XG4gICAgICB0aGlzLnJlZ2lvbiA9IGdldFJlZ2lvbihhbGxEUyk7XG4gICAgICB0aGlzLmtlbnRpayA9IG5ldyBLZW50aWtBUEkodGhpcy5iYWNrZW5kU3J2KTtcbiAgICAgIHRoaXMua2VudGlrLnNldFJlZ2lvbih0aGlzLnJlZ2lvbik7XG4gICAgICB0aGlzLmdldERldmljZSgkbG9jYXRpb24uc2VhcmNoKCkuZGV2aWNlKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZElQKCkge1xuICAgIHRoaXMub3RoZXJJcHMucHVzaCh7IGlwOiAnJyB9KTtcbiAgfVxuXG4gIHJlbW92ZUlQKGluZGV4KSB7XG4gICAgdGhpcy5vdGhlcklwcy5zcGxpY2UoaW5kZXgsIDEpO1xuICB9XG5cbiAgZ2V0RGV2aWNlKGRldmljZUlkKSB7XG4gICAgdGhpcy5iYWNrZW5kU3J2LmdldChgL2FwaS9wbHVnaW4tcHJveHkva2VudGlrLWFwcC8ke3RoaXMucmVnaW9ufS9hcGkvdjUvZGV2aWNlL2AgKyBkZXZpY2VJZCkudGhlbihyZXNwID0+IHtcbiAgICAgIHRoaXMuZGV2aWNlID0gcmVzcC5kZXZpY2U7XG4gICAgICB0aGlzLnVwZGF0ZURldmljZURUTygpO1xuICAgICAgdGhpcy5wYWdlUmVhZHkgPSB0cnVlO1xuICAgIH0pO1xuICB9XG5cbiAgZ290b0Rhc2hib2FyZChkZXZpY2VfbmFtZSkge1xuICAgIHRoaXMuJGxvY2F0aW9uLnVybCgnL2Rhc2hib2FyZC9kYi9rZW50aWstdG9wLXRhbGtlcnM/dmFyLWRldmljZT0nICsgZGV2aWNlX25hbWUpO1xuICB9XG5cbiAgdXBkYXRlRGV2aWNlRFRPKCkge1xuICAgIHRoaXMuZGV2aWNlRFRPID0ge1xuICAgICAgZGV2aWNlX2lkOiB0aGlzLmRldmljZS5pZCxcbiAgICAgIGRldmljZV9uYW1lOiB0aGlzLmRldmljZS5kZXZpY2VfbmFtZSxcbiAgICAgIGRldmljZV90eXBlOiB0aGlzLmRldmljZS5kZXZpY2VfdHlwZSxcbiAgICAgIGRldmljZV9kZXNjcmlwdGlvbjogdGhpcy5kZXZpY2UuZGV2aWNlX2Rlc2NyaXB0aW9uLFxuICAgICAgZGV2aWNlX2Zsb3dfdHlwZTogdGhpcy5kZXZpY2UuZGV2aWNlX2Zsb3dfdHlwZSxcbiAgICAgIGRldmljZV9zYW1wbGVfcmF0ZTogcGFyc2VJbnQodGhpcy5kZXZpY2UuZGV2aWNlX3NhbXBsZV9yYXRlLCAxMCksXG4gICAgICBtaW5pbWl6ZV9zbm1wOiB0aGlzLmRldmljZS5taW5pbWl6ZV9zbm1wLFxuICAgICAgZGV2aWNlX3NubXBfaXA6IHRoaXMuZGV2aWNlLmRldmljZV9zbm1wX2lwLFxuICAgICAgZGV2aWNlX3NubXBfY29tbXVuaXR5OiB0aGlzLmRldmljZS5kZXZpY2Vfc25tcF9jb21tdW5pdHksXG4gICAgICBkZXZpY2VfYmdwX3R5cGU6IHRoaXMuZGV2aWNlLmRldmljZV9iZ3BfdHlwZSxcbiAgICAgIGRldmljZV9iZ3BfcGFzc3dvcmQ6IHRoaXMuZGV2aWNlLmRldmljZV9iZ3BfcGFzc3dvcmQsXG4gICAgICBkZXZpY2VfYmdwX25laWdoYm9yX2lwOiB0aGlzLmRldmljZS5kZXZpY2VfYmdwX25laWdoYm9yX2lwLFxuICAgICAgZGV2aWNlX2JncF9uZWlnaGJvcl9hc246IHBhcnNlSW50KHRoaXMuZGV2aWNlLmRldmljZV9iZ3BfbmVpZ2hib3JfYXNuLCAxMCksXG4gICAgfTtcbiAgfVxuXG4gIHVwZGF0ZSgpIHtcbiAgICBpZiAoIXRoaXMuZGV2aWNlRFRPLmRldmljZV9zbm1wX2lwKSB7XG4gICAgICBkZWxldGUgdGhpcy5kZXZpY2VEVE8uZGV2aWNlX3NubXBfaXA7XG4gICAgfVxuICAgIGlmICghdGhpcy5kZXZpY2VEVE8uZGV2aWNlX3NubXBfY29tbXVuaXR5KSB7XG4gICAgICBkZWxldGUgdGhpcy5kZXZpY2VEVE8uZGV2aWNlX3NubXBfY29tbXVuaXR5O1xuICAgIH1cbiAgICBjb25zdCBkYXRhID0geyBkZXZpY2U6IHRoaXMuZGV2aWNlRFRPIH07XG5cbiAgICB0aGlzLmJhY2tlbmRTcnYucHV0KGAvYXBpL3BsdWdpbi1wcm94eS9rZW50aWstYXBwLyR7dGhpcy5yZWdpb259L2FwaS92NS9kZXZpY2UvYCArIHRoaXMuZGV2aWNlRFRPLmRldmljZV9pZCwgZGF0YSkudGhlbihcbiAgICAgIHJlc3AgPT4ge1xuICAgICAgICBpZiAoJ2VycicgaW4gcmVzcCkge1xuICAgICAgICAgIHNob3dDdXN0b21BbGVydCgnRGV2aWNlIFVwZGF0ZSBmYWlsZWQuJywgcmVzcC5lcnIsICdlcnJvcicpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNob3dDdXN0b21BbGVydCgnRGV2aWNlIFVwZGF0ZWQuJywgdGhpcy5kZXZpY2VEVE8uZGV2aWNlX25hbWUsICdzdWNjZXNzJyk7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGV2aWNlKHRoaXMuZGV2aWNlRFRPLmRldmljZV9pZCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBlcnJvciA9PiB7XG4gICAgICAgIGlmICgnZXJyb3InIGluIGVycm9yLmRhdGEpIHtcbiAgICAgICAgICBzaG93Q3VzdG9tQWxlcnQoJ0RldmljZSBVcGRhdGUgZmFpbGVkLicsIGVycm9yLmRhdGEuZXJyb3IsICdlcnJvcicpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzaG93Q3VzdG9tQWxlcnQoJ0RldmljZSBVcGRhdGUgZmFpbGVkLicsIGVycm9yLCAnZXJyb3InKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICApO1xuICB9XG59XG5cbkRldmljZURldGFpbHNDdHJsLnRlbXBsYXRlVXJsID0gJ2NvbXBvbmVudHMvZGV2aWNlX2RldGFpbHMuaHRtbCc7XG4iXSwic291cmNlUm9vdCI6IiJ9