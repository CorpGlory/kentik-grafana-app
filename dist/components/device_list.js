define(["lodash","angular","app/core/core"],function(t,e,n){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=9)}([function(e,n){e.exports=t},function(t,e,n){"use strict";function r(t){var e="default";for(var n in t)if("kentik-ds"===t[n].type)return e=t[n].jsonData.region;return e}n.d(e,"a",function(){return r})},function(t,n){t.exports=e},function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"b",function(){return a});var r=n(5),i=n(0);function o(t){var e="";e+=t.status?"("+t.status+") ":"",e+=t.statusText?t.statusText+": ":"",t.data&&t.data.error?e+=t.data.error:t.err?e+=t.err:i.isString(t)&&(e+=t),r.appEvents.emit("alert-error",["Can't connect to Kentik API",e])}function a(t,e,n){var o="";o+=e.status?"("+e.status+") ":"",o+=e.statusText?e.statusText+": ":"",e.data&&e.data.error?o+=e.data.error:e.err?o+=e.err:i.isString(e)&&(o+=e),r.appEvents.emit("alert-"+n,[t,o])}},function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n(2),i=n.n(r),o=n(1),a=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},s=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},u=function(){function t(t){var e=this;this.backendSrv=t,this.apiReady=!1,this.baseUrl="/api/plugin-proxy/kentik-app",t.get("/api/datasources").then(function(t){e.region=Object(o.a)(t),e.setRegion(e.region),e.apiReady=!0})}return t.$inject=["backendSrv"],t.prototype.setRegion=function(t){this.region=t},t.prototype.getDevices=function(){return a(this,void 0,void 0,function(){var t,e=this;return s(this,function(n){switch(n.label){case 0:return this.backendSrv.get("/api/datasources").then(function(t){e.region=Object(o.a)(t),e.setRegion(e.region),e.apiReady=!0}),[4,this._get("/api/v5/devices")];case 1:return(t=n.sent()).data&&t.data.devices?[2,t.data.devices]:[2,[]]}})})},t.prototype.getUsers=function(){return this._get("/api/v5/users")},t.prototype.getFieldValues=function(t){var e="SELECT DISTINCT "+t+" FROM all_devices ORDER BY "+t+" ASC";return this.invokeSQLQuery(e)},t.prototype.getCustomDimensions=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this._get("/api/v5/customdimensions")];case 1:return[2,t.sent().data.customDimensions]}})})},t.prototype.getSavedFilters=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this._get("/api/v5/saved-filters")];case 1:return[2,t.sent().data]}})})},t.prototype.invokeTopXDataQuery=function(t){var e={queries:[{query:t,bucketIndex:0}]};return this._post("/api/v5/query/topXdata",e)},t.prototype.invokeSQLQuery=function(t){var e={query:t};return this._post("/api/v5/query/sql",e)},t.prototype._get=function(t){return a(this,void 0,void 0,function(){var e=this;return s(this,function(n){switch(n.label){case 0:return void 0!==this.region?[3,2]:[4,this.backendSrv.get("/api/datasources").then(function(t){e.setRegion(Object(o.a)(t))})];case 1:n.sent(),n.label=2;case 2:return[2,this.backendSrv.datasourceRequest({method:"GET",url:this.baseUrl+"/"+this.region+t}).catch(function(t){return console.error(t),t.err?Promise.reject(t.err):Promise.reject(t)})]}})})},t.prototype._post=function(t,e){return a(this,void 0,void 0,function(){var n=this;return s(this,function(r){switch(r.label){case 0:return void 0!==this.region?[3,2]:[4,this.backendSrv.get("/api/datasources").then(function(t){n.setRegion(Object(o.a)(t))})];case 1:r.sent(),r.label=2;case 2:return[2,this.backendSrv.datasourceRequest({method:"POST",url:this.baseUrl+"/"+this.region+t,data:e}).then(function(t){return t.data?t.data:[]}).catch(function(t){return console.error(t),t.err?Promise.reject(t.err):Promise.reject(t)})]}})})},t}();i.a.module("grafana.services").service("kentikAPISrv",u)},function(t,e){t.exports=n},,,,function(t,e,n){"use strict";n.r(e),n.d(e,"DeviceListCtrl",function(){return o});var r=n(4),i=n(3),o=function(){function t(t,e,n,i){this.$scope=t,this.$location=n,this.backendSrv=i,this.devices=[],this.pageReady=!1,this.kentik=new r.a(this.backendSrv),this.getDevices()}return t.$inject=["$scope","$injector","$location","backendSrv"],t.prototype.getDevices=function(){var t=this;try{this.kentik.getDevices().then(function(e){t.devices=e,t.pageReady=!0,t.$scope.$apply()})}catch(t){Object(i.a)(t)}},t.prototype.refresh=function(){this.getDevices()},t.prototype.gotoDashboard=function(t){this.$location.path("/dashboard/db/kentik-top-talkers").search({"var-device":t.device_name})},t.prototype.gotoDeviceDetail=function(t){this.$location.url("/plugins/kentik-app/page/device-details?device="+t.id)},t}();o.templateUrl="components/device_list.html"}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwibG9kYXNoXCIiLCJ3ZWJwYWNrOi8vLy4vZGF0YXNvdXJjZS9yZWdpb25IZWxwZXIudHMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiYW5ndWxhclwiIiwid2VicGFjazovLy8uL2RhdGFzb3VyY2UvYWxlcnRIZWxwZXIudHMiLCJ3ZWJwYWNrOi8vLy4vZGF0YXNvdXJjZS9rZW50aWtBUEkudHMiLCJ3ZWJwYWNrOi8vLy4vY29tcG9uZW50cy9kZXZpY2VfbGlzdC50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIl9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzBfXyIsImdldFJlZ2lvbiIsImRhdGFzb3VyY2VzIiwiYVJlZ2lvbiIsImluZGV4IiwidHlwZSIsImpzb25EYXRhIiwicmVnaW9uIiwiX193ZWJwYWNrX2V4cG9ydHNfXyIsIl9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzJfXyIsInNob3dBbGVydCIsInNob3dDdXN0b21BbGVydCIsImdyYWZhbmFfYXBwX2NvcmVfY29yZV9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fIiwibG9kYXNoX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX18iLCJlcnJvciIsIm1lc3NhZ2UiLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwiZGF0YSIsImVyciIsImVtaXQiLCJleGNlcHRpb25EYXRhIiwiZXhjZXB0aW9uVHlwZSIsImVyck1lc3NhZ2UiLCJLZW50aWtBUEkiLCJiYWNrZW5kU3J2IiwiX3RoaXMiLCJ0aGlzIiwiYXBpUmVhZHkiLCJiYXNlVXJsIiwidGhlbiIsImFsbERTIiwiX3JlZ2lvbkhlbHBlcl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fIiwic2V0UmVnaW9uIiwiJGluamVjdCIsInJlc3AiLCJfYSIsInNlbnQiLCJkZXZpY2VzIiwiZ2V0VXNlcnMiLCJfZ2V0IiwiZ2V0RmllbGRWYWx1ZXMiLCJmaWVsZCIsInF1ZXJ5IiwiaW52b2tlU1FMUXVlcnkiLCJpbnZva2VUb3BYRGF0YVF1ZXJ5Iiwia2VudGlrVjVRdWVyeSIsInF1ZXJpZXMiLCJidWNrZXRJbmRleCIsIl9wb3N0IiwiZGF0YXNvdXJjZVJlcXVlc3QiLCJtZXRob2QiLCJ1cmwiLCJjYXRjaCIsImNvbnNvbGUiLCJQcm9taXNlIiwicmVqZWN0IiwicmVzcG9uc2UiLCJEZXZpY2VMaXN0Q3RybCIsIl9kYXRhc291cmNlX2tlbnRpa0FQSV9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fIiwiX2RhdGFzb3VyY2VfYWxlcnRIZWxwZXJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfXyIsIiRzY29wZSIsIiRpbmplY3RvciIsIiRsb2NhdGlvbiIsInBhZ2VSZWFkeSIsImtlbnRpayIsImdldERldmljZXMiLCIkYXBwbHkiLCJlIiwicmVmcmVzaCIsImdvdG9EYXNoYm9hcmQiLCJkZXZpY2UiLCJwYXRoIiwic2VhcmNoIiwidmFyLWRldmljZSIsImRldmljZV9uYW1lIiwiZ290b0RldmljZURldGFpbCIsImlkIl0sIm1hcHBpbmdzIjoiK0VBQ0EsSUFBQUEsRUFBQSxHQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVB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QUFBRyxFQUFjQyxFQUFBQyxFQUFBdEMsR0FBU0UsS0FBQWtDLFNBQ25FbEMsS0FBS29DLFVBQVlBLEVBQ2pCcEMsS0FBS0YsV0FBWUEsRUFDakJFLEtBQUtXLFFBQVMsR0FDZFgsS0FBS3FDLFdBQVksRUFDbEJyQyxLQUFBc0MsT0FBQSxJQUFBTixFQUFBLEVBQUFoQyxLQUFBRixZQUVERSxLQUFBdUMsYUF5QkYsU0FoQzRCaEMsUUFBQSxrREFRcEJ0QyxVQUFBc0UsV0FBQSxlQUNGeEMsRUFBS0MsY0FFSHNDLE9BQUtDLGFBQVlwQyxLQUFLLFNBQUFRLEdBQ3RCWixFQUFLWSxRQUFPQSxFQUNYWixFQUFBc0MsV0FBQSxFQUNKdEMsRUFBQW1DLE9BQUFNLGlCQUVBQyxHQUNGMUYsT0FBQWtGLEVBQUEsRUFBQWxGLENBQUEwRixLQUlEVixFQUFDOUQsVUFBQXlFLFFBQUEsV0FFRDFDLEtBQUF1QyxjQUVBUixFQUFDOUQsVUFBQTBFLGNBQUEsU0FBQUMsR0FFRDVDLEtBQUFvQyxVQUFBUyxLQUFBLG9DQUF1QkMsT0FBQSxDQUFBQyxhQUFBSCxFQUFBSSxlQUV2QmpCLEVBQUM5RCxVQUFBZ0YsaUJBQUEsU0FBQUwsR0FDSDVDLEtBQUFvQyxVQUFBWCxJQUFDLGtEQUFBbUIsRUFBQU0sS0FFRG5CLEVBakNrQiIsImZpbGUiOiJjb21wb25lbnRzL2RldmljZV9saXN0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDkpO1xuIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18wX187IiwiIC8qKlxuICAqIFJldHVybnMgdGhlIHJlZ2lvbiBhc3NvY2lhdGVkIHdpdGggdGhlIGtlbnRpay1rc1xuXG4gICogQHBhcmFtIGRhdGFzb3VyY2VzIFxuICAqL1xuZnVuY3Rpb24gZ2V0UmVnaW9uKGRhdGFzb3VyY2VzOiBhbnkpOiBzdHJpbmcge1xuICBsZXQgYVJlZ2lvbiA9IFwiZGVmYXVsdFwiO1xuICBmb3IgKHZhciBpbmRleCBpbiBkYXRhc291cmNlcykge1xuICAgIGlmIChkYXRhc291cmNlc1tpbmRleF0udHlwZSA9PT0gXCJrZW50aWstZHNcIikge1xuICAgICAgLy9jb25zb2xlLmxvZyhcImdldFJlZ2lvbjogZm91bmQgcmVnaW9uOiBcIiArZGF0YXNvdXJjZXNbaW5kZXhdLmpzb25EYXRhLnJlZ2lvbik7XG4gICAgICAvL2NvbnNvbGUubG9nKGFsbERTW2luZGV4XSk7XG4gICAgICBhUmVnaW9uID0gZGF0YXNvdXJjZXNbaW5kZXhdLmpzb25EYXRhLnJlZ2lvbjtcbiAgICAgIHJldHVybiBhUmVnaW9uO1xuICAgIH1cbiAgfVxuICByZXR1cm4gYVJlZ2lvbjtcbn1cblxuZXhwb3J0IHsgZ2V0UmVnaW9uIH1cbiIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fMl9fOyIsImltcG9ydCB7IGFwcEV2ZW50cyB9IGZyb20gJ2dyYWZhbmEvYXBwL2NvcmUvY29yZSc7XG5pbXBvcnQgKiBhcyBfIGZyb20gJ2xvZGFzaCc7XG5cbmZ1bmN0aW9uIHNob3dBbGVydChlcnJvcikge1xuICBsZXQgbWVzc2FnZSA9ICcnO1xuICBtZXNzYWdlICs9IGVycm9yLnN0YXR1cyA/IGAoJHtlcnJvci5zdGF0dXN9KSBgIDogJyc7XG4gIG1lc3NhZ2UgKz0gZXJyb3Iuc3RhdHVzVGV4dCA/IGVycm9yLnN0YXR1c1RleHQgKyAnOiAnIDogJyc7XG4gIGlmIChlcnJvci5kYXRhICYmIGVycm9yLmRhdGEuZXJyb3IpIHtcbiAgICBtZXNzYWdlICs9IGVycm9yLmRhdGEuZXJyb3I7XG4gIH0gZWxzZSBpZiAoZXJyb3IuZXJyKSB7XG4gICAgbWVzc2FnZSArPSBlcnJvci5lcnI7XG4gIH0gZWxzZSBpZiAoXy5pc1N0cmluZyhlcnJvcikpIHtcbiAgICBtZXNzYWdlICs9IGVycm9yO1xuICB9XG5cbiAgYXBwRXZlbnRzLmVtaXQoJ2FsZXJ0LWVycm9yJywgW1wiQ2FuJ3QgY29ubmVjdCB0byBLZW50aWsgQVBJXCIsIG1lc3NhZ2VdKTtcbn1cblxuZnVuY3Rpb24gc2hvd0N1c3RvbUFsZXJ0KG1lc3NhZ2UsIGV4Y2VwdGlvbkRhdGEsIGV4Y2VwdGlvblR5cGUpIHtcbiAgbGV0IGVyck1lc3NhZ2UgPSAnJztcbiAgZXJyTWVzc2FnZSArPSBleGNlcHRpb25EYXRhLnN0YXR1cyA/IGAoJHtleGNlcHRpb25EYXRhLnN0YXR1c30pIGAgOiAnJztcbiAgZXJyTWVzc2FnZSArPSBleGNlcHRpb25EYXRhLnN0YXR1c1RleHQgPyBleGNlcHRpb25EYXRhLnN0YXR1c1RleHQgKyAnOiAnIDogJyc7XG4gIGlmIChleGNlcHRpb25EYXRhLmRhdGEgJiYgZXhjZXB0aW9uRGF0YS5kYXRhLmVycm9yKSB7XG4gICAgZXJyTWVzc2FnZSArPSBleGNlcHRpb25EYXRhLmRhdGEuZXJyb3I7XG4gIH0gZWxzZSBpZiAoZXhjZXB0aW9uRGF0YS5lcnIpIHtcbiAgICBlcnJNZXNzYWdlICs9IGV4Y2VwdGlvbkRhdGEuZXJyO1xuICB9IGVsc2UgaWYgKF8uaXNTdHJpbmcoZXhjZXB0aW9uRGF0YSkpIHtcbiAgICBlcnJNZXNzYWdlICs9IGV4Y2VwdGlvbkRhdGE7XG4gIH1cbiAgYXBwRXZlbnRzLmVtaXQoYGFsZXJ0LSR7ZXhjZXB0aW9uVHlwZX1gLCBbbWVzc2FnZSwgZXJyTWVzc2FnZV0pO1xufVxuXG5leHBvcnQgeyBzaG93QWxlcnQsIHNob3dDdXN0b21BbGVydCB9O1xuIiwiaW1wb3J0ICogYXMgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgeyBnZXRSZWdpb24gfSBmcm9tIFwiLi9yZWdpb25IZWxwZXJcIjtcblxuZXhwb3J0IGNsYXNzIEtlbnRpa0FQSSB7XG4gIGJhc2VVcmw6IHN0cmluZztcbiAgcmVnaW9uOiBzdHJpbmc7XG4gIGFwaVJlYWR5OiBib29sZWFuO1xuICAvKiogQG5nSW5qZWN0ICovXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBiYWNrZW5kU3J2OiBhbnkpIHtcbiAgICB0aGlzLmFwaVJlYWR5ID0gZmFsc2U7XG4gICAgdGhpcy5iYXNlVXJsID0gXCIvYXBpL3BsdWdpbi1wcm94eS9rZW50aWstYXBwXCI7XG4gICAgLy8gZ2V0IHJlZ2lvbiBmcm9tIGRhdGFzb3VyY2VcbiAgICBiYWNrZW5kU3J2LmdldCgnL2FwaS9kYXRhc291cmNlcycpLnRoZW4oIChhbGxEUzogYW55KSA9PiB7XG4gICAgICB0aGlzLnJlZ2lvbiA9IGdldFJlZ2lvbihhbGxEUyk7XG4gICAgICB0aGlzLnNldFJlZ2lvbih0aGlzLnJlZ2lvbik7XG4gICAgICB0aGlzLmFwaVJlYWR5ID0gdHJ1ZTtcbiAgICB9KTtcbiAgfVxuXG4gIHNldFJlZ2lvbihyZWdpb246IHN0cmluZykge1xuICAgIHRoaXMucmVnaW9uID0gcmVnaW9uO1xuICB9XG5cbiAgYXN5bmMgZ2V0RGV2aWNlcygpIHtcbiAgICB0aGlzLmJhY2tlbmRTcnYuZ2V0KCcvYXBpL2RhdGFzb3VyY2VzJykudGhlbiggKGFsbERTOiBhbnkpID0+IHtcbiAgICAgIHRoaXMucmVnaW9uID0gZ2V0UmVnaW9uKGFsbERTKTtcbiAgICAgIHRoaXMuc2V0UmVnaW9uKHRoaXMucmVnaW9uKTtcbiAgICAgIHRoaXMuYXBpUmVhZHkgPSB0cnVlO1xuICAgIH0pO1xuXG4gICAgY29uc3QgcmVzcCA9IGF3YWl0IHRoaXMuX2dldCgnL2FwaS92NS9kZXZpY2VzJyk7XG5cbiAgICBpZiAocmVzcC5kYXRhICYmIHJlc3AuZGF0YS5kZXZpY2VzKSB7XG4gICAgICByZXR1cm4gcmVzcC5kYXRhLmRldmljZXM7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH1cblxuICBnZXRVc2VycygpIHtcbiAgICByZXR1cm4gdGhpcy5fZ2V0KCcvYXBpL3Y1L3VzZXJzJyk7XG4gIH1cblxuICBnZXRGaWVsZFZhbHVlcyhmaWVsZDogc3RyaW5nKSB7XG4gICAgY29uc3QgcXVlcnkgPSBgU0VMRUNUIERJU1RJTkNUICR7ZmllbGR9IEZST00gYWxsX2RldmljZXMgT1JERVIgQlkgJHtmaWVsZH0gQVNDYDtcbiAgICByZXR1cm4gdGhpcy5pbnZva2VTUUxRdWVyeShxdWVyeSk7XG4gIH1cblxuICBhc3luYyBnZXRDdXN0b21EaW1lbnNpb25zKCkge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLl9nZXQoJy9hcGkvdjUvY3VzdG9tZGltZW5zaW9ucycpO1xuICAgIHJldHVybiBkYXRhLmRhdGEuY3VzdG9tRGltZW5zaW9ucztcbiAgfVxuXG4gIGFzeW5jIGdldFNhdmVkRmlsdGVycygpIHtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5fZ2V0KCcvYXBpL3Y1L3NhdmVkLWZpbHRlcnMnKTtcbiAgICByZXR1cm4gZGF0YS5kYXRhO1xuICB9XG5cbiAgaW52b2tlVG9wWERhdGFRdWVyeShxdWVyeTogYW55KSB7XG4gICAgY29uc3Qga2VudGlrVjVRdWVyeSA9IHtcbiAgICAgIHF1ZXJpZXM6IFt7IHF1ZXJ5OiBxdWVyeSwgYnVja2V0SW5kZXg6IDAgfV0sXG4gICAgfTtcblxuICAgIHJldHVybiB0aGlzLl9wb3N0KCcvYXBpL3Y1L3F1ZXJ5L3RvcFhkYXRhJywga2VudGlrVjVRdWVyeSk7XG4gIH1cblxuICBpbnZva2VTUUxRdWVyeShxdWVyeTogYW55KSB7XG4gICAgY29uc3QgZGF0YSA9IHtcbiAgICAgIHF1ZXJ5OiBxdWVyeSxcbiAgICB9O1xuXG4gICAgcmV0dXJuIHRoaXMuX3Bvc3QoJy9hcGkvdjUvcXVlcnkvc3FsJywgZGF0YSk7XG4gIH1cblxuICBhc3luYyBfZ2V0KHVybDogc3RyaW5nKSB7XG4gICAgLy8gaWYgdGhlIHJlZ2lvbiBpcyBub3Qgc2V0LCBnZXQgaXQgZnJvbSB0aGUgZGF0YXNvdXJjZVxuICAgIGlmICh0eXBlb2YgdGhpcy5yZWdpb24gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAvL2NvbnNvbGUubG9nKFwiX2dldDogdGhpcy5yZWdpb24gVU5ERUZJTkVELCBmZXRjaGluZ1wiKTtcbiAgICAgIGF3YWl0IHRoaXMuYmFja2VuZFNydi5nZXQoJy9hcGkvZGF0YXNvdXJjZXMnKS50aGVuKCAoYWxsRFM6IGFueSkgPT4ge1xuICAgICAgICB0aGlzLnNldFJlZ2lvbihnZXRSZWdpb24oYWxsRFMpKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcImtlbnRpa0FQSTogX2dldDogRkVUQ0hFRCByZWdpb24gXCIgKyB0aGlzLnJlZ2lvbik7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuYmFja2VuZFNydlxuICAgICAgLmRhdGFzb3VyY2VSZXF1ZXN0KHtcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgdXJsOiB0aGlzLmJhc2VVcmwgKyBcIi9cIiArIHRoaXMucmVnaW9uICsgdXJsLFxuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICBpZiAoZXJyb3IuZXJyKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yLmVycik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gIH1cblxuICBhc3luYyBfcG9zdCh1cmw6IHN0cmluZywgZGF0YTogYW55KSB7XG4gICAgLy8gaWYgdGhlIHJlZ2lvbiBpcyBub3Qgc2V0LCBnZXQgaXQgZnJvbSB0aGUgZGF0YXNvdXJjZVxuICAgIGlmICh0eXBlb2YgdGhpcy5yZWdpb24gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAvL2NvbnNvbGUubG9nKFwia2VudGlrQVBJLl9wb3N0OiB0aGlzLnJlZ2lvbiBVTkRFRklORUQsIGZldGNoaW5nXCIpO1xuICAgICAgYXdhaXQgdGhpcy5iYWNrZW5kU3J2LmdldCgnL2FwaS9kYXRhc291cmNlcycpLnRoZW4oIChhbGxEUzogYW55KSA9PiB7XG4gICAgICAgIHRoaXMuc2V0UmVnaW9uKGdldFJlZ2lvbihhbGxEUykpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwia2VudGlrQVBJLl9wb3N0OiBGRVRDSEVEIHJlZ2lvbiBcIiArIHRoaXMucmVnaW9uKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5iYWNrZW5kU3J2XG4gICAgICAuZGF0YXNvdXJjZVJlcXVlc3Qoe1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgdXJsOiB0aGlzLmJhc2VVcmwgKyBcIi9cIiArIHRoaXMucmVnaW9uICsgdXJsLFxuICAgICAgICBkYXRhOiBkYXRhLFxuICAgICAgfSlcbiAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgICAgaWYgKGVycm9yLmVycikge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvci5lcnIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG59XG5cbmFuZ3VsYXIubW9kdWxlKCdncmFmYW5hLnNlcnZpY2VzJykuc2VydmljZSgna2VudGlrQVBJU3J2JywgS2VudGlrQVBJKTtcbiIsImltcG9ydCB7IEtlbnRpa0FQSSB9IGZyb20gJy4uL2RhdGFzb3VyY2Uva2VudGlrQVBJJztcbmltcG9ydCB7IHNob3dBbGVydCB9IGZyb20gXCIuLi9kYXRhc291cmNlL2FsZXJ0SGVscGVyXCI7XG5cbmltcG9ydCB7IGdldFJlZ2lvbiB9IGZyb20gXCIuLi9kYXRhc291cmNlL3JlZ2lvbkhlbHBlclwiO1xuY2xhc3MgRGV2aWNlTGlzdEN0cmwge1xuICBzdGF0aWMgdGVtcGxhdGVVcmw6IHN0cmluZztcbiAgZGV2aWNlczogYW55W107XG4gIHBhZ2VSZWFkeTogYm9vbGVhbjtcbiAga2VudGlrOiBLZW50aWtBUEk7XG5cbiAgLyoqIEBuZ0luamVjdCAqL1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlICRzY29wZSwgJGluamVjdG9yLCBwdWJsaWMgJGxvY2F0aW9uOiBhbnksIHB1YmxpYyBiYWNrZW5kU3J2OiBhbnkpIHtcbiAgICB0aGlzLmRldmljZXMgPSBbXTtcbiAgICB0aGlzLnBhZ2VSZWFkeSA9IGZhbHNlO1xuICAgIHRoaXMua2VudGlrID0gbmV3IEtlbnRpa0FQSSh0aGlzLmJhY2tlbmRTcnYpO1xuICAgIHRoaXMuZ2V0RGV2aWNlcygpO1xuICB9XG5cbiAgZ2V0RGV2aWNlcygpIHtcbiAgICB0cnkge1xuICAgICAgdGhpcy5rZW50aWsuZ2V0RGV2aWNlcygpLnRoZW4oKGRldmljZXMpID0+IHtcbiAgICAgICAgdGhpcy5kZXZpY2VzID0gZGV2aWNlcztcbiAgICAgICAgdGhpcy5wYWdlUmVhZHkgPSB0cnVlO1xuICAgICAgICB0aGlzLiRzY29wZS4kYXBwbHkoKTtcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHNob3dBbGVydChlKTtcbiAgICB9XG4gIH1cblxuICByZWZyZXNoKCkge1xuICAgIHRoaXMuZ2V0RGV2aWNlcygpO1xuICB9XG5cbiAgZ290b0Rhc2hib2FyZChkZXZpY2UpIHtcbiAgICB0aGlzLiRsb2NhdGlvbi5wYXRoKCcvZGFzaGJvYXJkL2RiL2tlbnRpay10b3AtdGFsa2VycycpLnNlYXJjaCh7ICd2YXItZGV2aWNlJzogZGV2aWNlLmRldmljZV9uYW1lIH0pO1xuICB9XG5cbiAgZ290b0RldmljZURldGFpbChkZXZpY2UpIHtcbiAgICB0aGlzLiRsb2NhdGlvbi51cmwoJy9wbHVnaW5zL2tlbnRpay1hcHAvcGFnZS9kZXZpY2UtZGV0YWlscz9kZXZpY2U9JyArIGRldmljZS5pZCk7XG4gIH1cbn1cblxuRGV2aWNlTGlzdEN0cmwudGVtcGxhdGVVcmwgPSAnY29tcG9uZW50cy9kZXZpY2VfbGlzdC5odG1sJztcblxuZXhwb3J0IHsgRGV2aWNlTGlzdEN0cmwgfTtcbiJdLCJzb3VyY2VSb290IjoiIn0=